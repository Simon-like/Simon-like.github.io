[{"title":"ã€æ¦‚å¿µè§£æã€‘å‰ç«¯å¼€å‘ä¸­çš„polypill","url":"/2025/07/22/ã€æ¦‚å¿µè§£æã€‘å‰ç«¯å¼€å‘ä¸­çš„Polyfill/","content":"\n\n\n## ä»€ä¹ˆæ˜¯ Polyfillï¼Ÿ\n\n**Polyfill** æ˜¯ä¸€æ®µä»£ç ï¼ˆé€šå¸¸æ˜¯ JavaScriptï¼‰ï¼Œç”¨æ¥ä¸ºæ—§æµè§ˆå™¨æä¾›å®ƒæ²¡æœ‰åŸç”Ÿæ”¯æŒçš„è¾ƒæ–°çš„åŠŸèƒ½ã€‚\n\n### åå­—çš„ç”±æ¥ ğŸ¨\n\n\"Polyfill\" è¿™ä¸ªè¯æ¥æºäºä¸€ç§å»ºç­‘ææ–™ Polyfillaï¼ˆä¸€ç§ç”¨äºå¡«è¡¥å¢™é¢è£‚ç¼çš„è…»å­ï¼‰ï¼Œå½¢è±¡åœ°è¡¨ç¤º\"å¡«è¡¥æµè§ˆå™¨åŠŸèƒ½çš„ç©ºç¼º\"ã€‚\n\n## ä¸ºä»€ä¹ˆéœ€è¦ Polyfillï¼Ÿ\n\n```javascript\n// ğŸŒ° ä¾‹å­ï¼šæ—§æµè§ˆå™¨ä¸æ”¯æŒ Array.includes\nconst fruits = ['apple', 'banana', 'orange'];\n\n// æ–°æµè§ˆå™¨å¯ä»¥ç›´æ¥ä½¿ç”¨\nconsole.log(fruits.includes('banana')); // true\n\n// æ—§æµè§ˆå™¨ä¼šæŠ¥é”™ï¼šfruits.includes is not a function\n```\n\n## å¸¸è§çš„ Polyfill ç¤ºä¾‹\n\n### 1. Array.includes Polyfill\n\n```javascript\n// æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨\nif (!Array.prototype.includes) {\n  Array.prototype.includes = function(searchElement, fromIndex) {\n    // ä¸¥æ ¼æ¨¡å¼\n    'use strict';\n    \n    const O = Object(this);\n    const len = parseInt(O.length) || 0;\n    \n    if (len === 0) return false;\n    \n    const n = parseInt(fromIndex) || 0;\n    let k = Math.max(n >= 0 ? n : len + n, 0);\n    \n    while (k < len) {\n      if (searchElement === O[k]) return true;\n      k++;\n    }\n    \n    return false;\n  };\n}\n```\n\n### 2. Promise Polyfill\n\n```javascript\n// ç®€åŒ–ç‰ˆ Promise polyfill\nif (typeof Promise === 'undefined') {\n  window.Promise = function(executor) {\n    // Promise å®ç°ä»£ç ...\n  };\n}\n```\n\n### 3. Object.assign Polyfill\n\n```javascript\nif (!Object.assign) {\n  Object.assign = function(target) {\n    'use strict';\n    \n    if (target == null) {\n      throw new TypeError('Cannot convert undefined or null to object');\n    }\n    \n    const output = Object(target);\n    \n    for (let index = 1; index < arguments.length; index++) {\n      const source = arguments[index];\n      if (source != null) {\n        for (const key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            output[key] = source[key];\n          }\n        }\n      }\n    }\n    \n    return output;\n  };\n}\n```\n\n### 4. String.padStart Polyfill\n\n```javascript\nif (!String.prototype.padStart) {\n  String.prototype.padStart = function(targetLength, padString) {\n    targetLength = targetLength >> 0; // è½¬ä¸ºæ•´æ•°\n    padString = String(padString || ' ');\n    \n    if (this.length >= targetLength) {\n      return String(this);\n    }\n    \n    targetLength = targetLength - this.length;\n    if (targetLength > padString.length) {\n      padString += padString.repeat(targetLength / padString.length);\n    }\n    \n    return padString.slice(0, targetLength) + String(this);\n  };\n}\n```\n\n## Polyfill vs å…¶ä»–æ¦‚å¿µ\n\n### 1. Polyfill vs Transpileï¼ˆè½¬è¯‘ï¼‰\n\n```javascript\n// Polyfillï¼šè¿è¡Œæ—¶è¡¥å……ç¼ºå¤±çš„ API\nArray.prototype.find = Array.prototype.find || function() { /* ... */ };\n\n// Transpileï¼šç¼–è¯‘æ—¶è½¬æ¢è¯­æ³•ï¼ˆå¦‚ Babelï¼‰\n// ES6 ç®­å¤´å‡½æ•°\nconst add = (a, b) => a + b;\n// è½¬è¯‘å\nvar add = function(a, b) { return a + b; };\n```\n\n### 2. Polyfill vs Shim\n\n- **Polyfill**ï¼šå®ç°æ ‡å‡† APIï¼Œè¡Œä¸ºä¸è§„èŒƒä¸€è‡´\n- **Shim**ï¼šå¯èƒ½æœ‰è‡ªå·±çš„ APIï¼Œä¸ä¸€å®šéµå¾ªæ ‡å‡†\n\n## å¦‚ä½•ä½¿ç”¨ Polyfillï¼Ÿ\n\n### 1. æ‰‹åŠ¨å¼•å…¥\n\n```html\n<!-- å¼•å…¥ç‰¹å®šçš„ polyfill -->\n<script src=\"https://polyfill.io/v3/polyfill.min.js?features=Promise,Array.from\"></script>\n```\n\n### 2. ä½¿ç”¨ core-js\n\n```javascript\n// å®‰è£…\nnpm install core-js\n\n// ä½¿ç”¨\nimport 'core-js/features/array/includes';\nimport 'core-js/features/promise';\n```\n\n### 3. ä½¿ç”¨ @babel/polyfillï¼ˆå·²åºŸå¼ƒï¼‰\n\n```javascript\n// æ–°çš„æ¨èæ–¹å¼\nnpm install core-js regenerator-runtime\n\n// babel.config.js\nmodule.exports = {\n  presets: [\n    ['@babel/preset-env', {\n      useBuiltIns: 'usage',\n      corejs: 3\n    }]\n  ]\n};\n```\n\n## æœ€ä½³å®è·µ\n\n### 1. æŒ‰éœ€åŠ è½½\n\n```javascript\n// åªåœ¨éœ€è¦æ—¶åŠ è½½ polyfill\nif (!window.Promise) {\n  // åŠ¨æ€åŠ è½½ Promise polyfill\n  loadScript('promise-polyfill.js');\n}\n```\n\n### 2. ä½¿ç”¨ polyfill.io æœåŠ¡\n\n```html\n<!-- æ ¹æ®ç”¨æˆ·æµè§ˆå™¨è‡ªåŠ¨è¿”å›éœ€è¦çš„ polyfill -->\n<script src=\"https://polyfill.io/v3/polyfill.min.js\"></script>\n```\n\n### 3. ç‰¹æ€§æ£€æµ‹\n\n```javascript\n// ä½¿ç”¨ç‰¹æ€§æ£€æµ‹è€Œä¸æ˜¯æµè§ˆå™¨æ£€æµ‹\nfunction loadPolyfills() {\n  const polyfills = [];\n  \n  if (!window.Promise) {\n    polyfills.push(import('promise-polyfill'));\n  }\n  \n  if (!Array.prototype.includes) {\n    polyfills.push(import('array-includes-polyfill'));\n  }\n  \n  return Promise.all(polyfills);\n}\n\n// åŠ è½½å®Œ polyfill åå†å¯åŠ¨åº”ç”¨\nloadPolyfills().then(() => {\n  // å¯åŠ¨åº”ç”¨\n  startApp();\n});\n```\n\n## å¸¸ç”¨çš„ Polyfill åº“\n\n1. **core-js** - æœ€å…¨é¢çš„ polyfill åº“\n2. **polyfill.io** - è‡ªåŠ¨åŒ– polyfill æœåŠ¡\n3. **es5-shim/es6-shim** - ES5/ES6 polyfill\n4. **fetch-polyfill** - Fetch API polyfill\n5. **intersection-observer** - IntersectionObserver polyfill\n\n## æ³¨æ„äº‹é¡¹ âš ï¸\n\n1. **æ€§èƒ½å½±å“**ï¼šPolyfill ä¼šå¢åŠ ä»£ç ä½“ç§¯\n2. **é€‰æ‹©æ€§åŠ è½½**ï¼šåªåŠ è½½éœ€è¦çš„ polyfill\n3. **ç‰ˆæœ¬å…¼å®¹**ï¼šç¡®ä¿ polyfill æ”¯æŒç›®æ ‡æµè§ˆå™¨\n4. **åŸç”Ÿä¼˜å…ˆ**ï¼šä¼˜å…ˆä½¿ç”¨åŸç”Ÿå®ç°\n\n```javascript\n// å¥½çš„åšæ³•ï¼šå…ˆæ£€æµ‹å†æ·»åŠ \nif (!Array.prototype.flat) {\n  // æ·»åŠ  polyfill\n}\n\n// é¿å…ï¼šç›´æ¥è¦†ç›–\nArray.prototype.flat = function() { /* ... */ };\n```\n\næ€»ä¹‹ï¼ŒPolyfill æ˜¯å‰ç«¯å¼€å‘ä¸­å®ç°å‘åå…¼å®¹çš„é‡è¦æ‰‹æ®µï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨æ—§æµè§ˆå™¨ä¸­ä½¿ç”¨æ–°ç‰¹æ€§ï¼","tags":["å‰ç«¯å¼€å‘","æ¦‚å¿µè§£æ"],"categories":["å‰ç«¯çŸ¥è¯†å°å†Œ"]},{"title":"ã€ç§‹æ‹›å‡†å¤‡ã€‘é¢è¯•æ‰‹æ’•å¤§é›†åˆ","url":"/2025/07/22/ã€ç§‹æ‹›å¤‡æˆ˜ã€‘é¢è¯•æ‰‹æ’•å¤§é›†åˆ/","content":"\n# **æ‰€æœ‰éå†æ•°ç»„çš„æ–¹æ³•**\n\n\n\n## forEach\n\n```JavaScript\n// è‡ªå®šä¹‰ forEach å‡½æ•°ï¼Œæ·»åŠ åˆ° Array åŸå‹é“¾\nArray.prototype.myForEach = function (callback, thisArg) {\n\n    // ç±»å‹æ£€æŸ¥ï¼šç¡®ä¿ callback æ˜¯ä¸€ä¸ªå‡½æ•°\n    if (typeof callback !== 'function') {\n        throw new TypeError('ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°');\n    }\n\n    // éå†æ•°ç»„ï¼Œè°ƒç”¨ callback å‡½æ•°\n    for (let i = 0; i < this.length; i++) {\n        // å¦‚æœæ•°ç»„çš„å½“å‰å…ƒç´ æ˜¯ undefined æˆ– null, åˆ™è·³è¿‡\n        if (i in this) {//å¯¹äºæ•°ç»„è€Œè¨€ï¼Œinè¿ç®—ç¬¦ç”¨äºæ£€æŸ¥æ˜¯å¦æœ‰è¿™ä¸ªç´¢å¼•å€¼\n            callback.call(thisArg, this[i], i, this);\n        }\n    }\n};\n```\n\n## map\n\n```JavaScript\n// è‡ªå®šä¹‰ Map å‡½æ•°ï¼Œæ·»åŠ åˆ° Array åŸå‹é“¾\nArray.prototype.myMap = function (callback) {\n\n    // ç±»å‹æ£€æŸ¥ï¼šç¡®ä¿ callback æ˜¯ä¸€ä¸ªå‡½æ•°\n    if (typeof callback !== 'function') {\n        throw new TypeError('ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°');\n    }\n    let res = [];\n\n    // éå†æ•°ç»„ï¼Œè°ƒç”¨ callback å‡½æ•°\n    for (let i = 0; i < this.length; i++) {\n        // å¦‚æœæ•°ç»„çš„å½“å‰å…ƒç´ æ˜¯ undefined æˆ– null, åˆ™è·³è¿‡\n        if (i in this) {\n            res.push(callback(this[i], i, this));\n        }\n    }\n    return res\n};\n```\n\n## Filter\n\n```JavaScript\nArray.prototype.my_filter = function (cb) {\n    let newArr = []\n    for (var i = 0; i < this.length; i++) {\n        if (cb(this[i], i, this)) {\n            newArr.push(this[i])\n        }\n    }\n    return newArr\n}\n```\n\n## every(åˆ¤æ–­æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦éƒ½æ»¡è¶³æŸä¸ªæ¡ä»¶)\n\n```JavaScript\nArray.prototype.my_every = function (cb) {\n    for (let i = 0; i < this.length; i++) {\n        if (!cb(this[i], i, this)) {\n            return false;\n        }\n    }\n    return true;\n}\n```\n\n## someï¼ˆåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå…ƒç´ æ»¡è¶³æŸä¸ªæ¡ä»¶ï¼‰\n\n```JavaScript\nArray.prototype.my_some = function (cb) {\n    for (let i = 0; i < this.length; i++) {\n        if (cb(this[i], i, this)) {\n            return true;\n        }\n    }\n    return false;\n}\n```\n\n## reduce\n\n```JavaScript\nArray.prototype.my_reduce = function (cb, ...args) {\n    let start, index = 0\n    if (args.length) {\n        start = args[0]\n    } else {\n        start = this[0];\n        index = 1\n    }\n    for (let i = index; i < this.length; i++) {\n        start = cb(start, this[i], i, this);\n    }\n    return start;\n}\n```\n\n## includes\n\n```JavaScript\nArray.prototype.my_includes = function (item, ...args) {\n    let index\n    if (args.length && !Number.isNaN(Number(args[0])) && Number(args[0])>0) {\n        index = Number(args[0])\n    } else {\n        index = 0;\n    }\n    for (let i = index; i < this.length; i++) {\n        if (this[i] === item) return true;\n    }\n    return false\n}\n```\n\n## splice\n\n```JavaScript\nlet arr = ['a', 'b', 'c', 'd', 'e']\n\nArray.prototype.my_splice = function (start, len, ...args) {\n   // å¦‚æœæ²¡æœ‰ä»»ä½•å‚æ•°ä¼ é€’ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„\n    if (arguments.length === 0) {\n        return [];\n    }\n    \n    // å¦‚æœ start æ˜¯ undefinedï¼Œè®¾ç½®ä¸º 0\n    if (start === undefined) {\n        start = 0;\n    }else if(start<0){\n        start = this.length+start \n        start = !!start?start:0\n    }\n\n    // å¦‚æœ len æ˜¯ undefinedï¼Œè®¾ç½®ä¸º 0\n    if (len === undefined) {\n        len = 0;\n    }\n    \n    const res = [], newArr = []\n    for (let i = 0; i < this.length; i++) {\n        if (i < start || i >= start + len) {\n            newArr.push(this[i])\n        } else {\n            res.push(this[i])\n        }\n        //è¿˜æœ‰è¦æ·»åŠ çš„å€¼æ˜¯å­˜æ”¾åœ¨argsé‡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦æŠŠargsä¸­çš„å€¼æ·»åŠ åˆ°åŸæ•°ç»„ä¸­å»\n        if (i === start - 1) {\n            newArr.push(...args)\n        }\n    }\n    \n    while (this.length) {\n        this.pop()\n    }\n    this.push(...newArr)\n    return res\n}\n```\n\n# JSå†…ç½®æ–¹æ³•ã€å¯¹è±¡ä»¥åŠè¿ç®—ç¬¦\n\n## newè¿ç®—ç¬¦\n\n```javascript\nfunction myNew (Func, ...arg){\n        if (fn.prototype === undefined) throw new TypeError('function is not a constructor');\n        let obj = {}  //å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ã€‚\n        obj.__proto__ = Func.prototype  \n        //å°†Func.prototypeèµ‹å€¼ä¸ºå¯¹è±¡çš„__proto__å±æ€§,å³åŸå‹é“¾çš„æ¦‚å¿µ\n        let res = Func.call(obj, ...arg) //æ›´æ”¹Funcçš„thisæŒ‡å‘\n        return res instanceof Object ? res : obj \n}\n```\n\n## æ‰‹æ’•curry\n\n```javascript\nconst my_curry = (fn, ...args) =>\n    args.length >= fn.length\n        ? fn(...args)\n        : (...args1) => my_curry(fn, ...args, ...args1);\n\nfunction adder(x, y, z) {\n    return x + y + z;\n}\nconst add = my_curry(adder);\nconsole.log(add(1, 2, 3));  //6\nconsole.log(add(1)(2)(3));  //6\nconsole.log(add(1, 2)(3));  //6\nconsole.log(add(1)(2, 3));  //6\n```\n\n## æ‰‹å†™composeå‡½æ•°\n\n```JavaScript\nconst compose = (...fns)=>(x)=>fns.reduceRight((v, fn)=>fn(v),x);\nconst doubleAndSuare = compose(double, square);//å…ˆç¿»å€å†å¹³æ–¹\nconsole.log(doubleAndSuare(3));\n```\n\n## æ‰‹æ’•vue3å“åº”å¼ä»£ç†\n\n```javascript\n//æµ‹è¯•ä»£ç \nclass Depend {\n  constructor() {\n    this.reactiveFns = new Set()//ä¾èµ–ç»„\n  }\n\n  // æ›´å¥½çš„æ”¶é›†ä¾èµ–\n  depend() {\n    if (activeReactiveFn) this.reactiveFns.add(activeReactiveFn)\n  }\n\n  //å¯¹æ‰€æœ‰ä¾èµ–è¿›è¡Œç»Ÿä¸€é€šçŸ¥å¤„ç†\n  notify() {\n    console.log(this.reactiveFns)\n    this.reactiveFns.forEach(fn => {\n      //éå†ä¾èµ–å¤„ç†\n      if (fn) fn()\n    })\n  }\n}\n\n// å°è£…å“åº”å¼å‡½æ•°\nlet activeReactiveFn = null\nfunction watchFn(fn) {\n  activeReactiveFn = fn\n  fn()\n  activeReactiveFn = null\n}\n\n// å°è£…ä¸€ä¸ªè·å–dependå‡½æ•°\nconst targetMap = new WeakMap()\nfunction getDepend(target, key) {\n  // 1ã€æ ¹æ®targetå¯¹è±¡è·å–mapçš„è¿‡ç¨‹\n  let map = targetMap.get(target)\n  if (!map) {\n    map = new Map()\n    targetMap.set(target, map)\n  }\n  // 2ã€æ ¹æ®å¯¹è±¡å±æ€§è·å–dependä¾èµ–\n  let depend = map.get(key)\n  if (!depend) {\n    depend = new Depend()\n    map.set(key, depend)\n  }\n  return depend\n}\n\n\n//ä½¿ç”¨Proxyç›‘å¬å¯¹è±¡å˜åŒ–\nfunction reactive(obj) {\n  return new Proxy(obj, {\n    get: function (target, key, receiver) {\n      const depend = getDepend(target, key)\n      depend.depend()\n      return Reflect.get(target, key, receiver)\n    },\n    set: function (target, key, newValue, receiver) {\n      Reflect.set(target, key, newValue, receiver)\n      const depend = getDepend(target, key)\n      depend.notify()\n    }\n  })\n}\n\nconst obj = {\n  name: \"coderwhy\",//dependå®ä¾‹å¯¹è±¡\n  age: 18//dependå®ä¾‹å¯¹è±¡\n}\n\nconst info = {\n  name:\"å°ä½™\",\n  age:18\n}\n//å“åº”å¼å¼€å…³åª’ä»‹\nconst objRef = reactive({\n  name: \"coderwhy\",\n  age: 18\n})\nconst infoRef = reactive({\n  name:\"å°ä½™\",\n  age:18\n})\n\nwatchFn(() => {\n  console.log(infoRef.name);  \n})\nwatchFn(() => {\n  console.log(objRef.name);  \n})\n\ninfoRef.name = 'å“åº”å¼-å°ä½™'\nobjRef.name = 'å“åº”å¼-coderwhy'\n\n// å°ä½™\n// coderwhy\n// Set(1) { [Function (anonymous)] }\n// å“åº”å¼-å°ä½™\n// Set(1) { [Function (anonymous)] }\n// å“åº”å¼-coderwhy\n```\n\n## æ‰‹æ’•instanceof\n\n```sql\nconst myInstanceOf=(Left,Right)=>{\n  if(!Left){\n    return false\n  }\n  while(Left){\n    if(Left.__proto__===Right.prototype){\n      return true\n    }else{\n      Left=Left.__proto__\n    }\n  }\n  return false\n}\n\n//éªŒè¯\nconsole.log(myInstanceOf({},Array));  //false\n```\n\n## callï¼Œbindï¼Œapply\n\n```javascript\nfunction foo(x,y){\n  console.log(this.a,x+y);\n}\n\nconst obj={\n  a:1\n}\n\nFunction.prototype.myCall=function(context,...args){\n  if(typeof this !== 'function')  return new TypeError('is not a function')\n  const fn = Symbol('fn') //ä½¿ç”¨Symbolå°½å¯èƒ½é™ä½myCallå¯¹å…¶ä»–çš„å½±å“\n  context[fn] = this  //thisæŒ‡å‘foo\n  const res = context[fn](...args)  //è§£æ„ï¼Œè°ƒç”¨fn\n  delete context[fn]  //ä¸è¦å¿˜äº†åˆ é™¤objä¸Šçš„å·¥å…·å‡½æ•°fn\n  return res  //å°†ç»“æœè¿”å›\n}\n\n//éªŒè¯\nfoo.myCall(obj,1,2)   //1,3\n\nfunction foo(x,y){\n  console.log(this.a,x+y);\n}\n\nconst obj={\n  a:1\n}\n\nFunction.prototype.myApply=function(context,args){\n  if(typeof this !== 'function')  return new TypeError('is not a function')\n  const fn = Symbol('fn') //ä½¿ç”¨Symbolå°½å¯èƒ½é™ä½myCallå¯¹å…¶ä»–çš„å½±å“\n  context[fn] = this  //thisæŒ‡å‘foo\n  const res = context[fn](...args)  //è§£æ„ï¼Œè°ƒç”¨fn\n  delete context[fn]  //ä¸è¦å¿˜äº†åˆ é™¤objä¸Šçš„å·¥å…·å‡½æ•°fn\n  return res  //å°†ç»“æœè¿”å›\n}\n\n//éªŒè¯\nfoo.myApply(obj,1,2)   //1,3\n\nfunction foo(x,y,z){\n  this.name='zt'\n  console.log(this.a,x+y+z);\n}\n\nconst obj={\n  a:1\n}\n\nFunction.prototype.myBind=function(context,...args){\n  if(typeof this !== 'function')  return new TypeError('It is not a function');\n  context = context || window; // ä¸Šä¸‹æ–‡ç¯å¢ƒ\n  const _this = this; // å½“å‰çš„å‡½æ•°çš„ä¸Šä¸‹æ–‡this\n  return function F(...arg) {\n    //åˆ¤æ–­è¿”å›å‡ºå»çš„Fæœ‰æ²¡æœ‰è¢«newï¼Œæœ‰å°±è¦æŠŠfooç»™åˆ°newå‡ºæ¥çš„å¯¹è±¡\n    if (this instanceof F) {\n       return new _this(...args, ...arg);\n    } else {\n       _this.call(this, ...args, ...arg);\n    }\n  }\n}\n\n//éªŒè¯\nconst bar=foo.myBind(obj,1,2)\nconsole.log(new bar(3));   //undefined 6  foo { name: 'zt' }\n```\n\n## å€¼ç›¸ç­‰\n\n```javascript\nfunction compare(data1, data2) {\n  if (typeof data1 != typeof data2) {\n    return false;\n  }\n\n  if (typeof data1 != \"object\" && typeof data1 == typeof data2) {\n    return data1 === data2;\n  }\n\n  if ((!data1 instanceof Array && data2 instanceof Array) || (data1 instanceof Array && !data2 instanceof Array)) {\n    return false;\n  } else if (data1 instanceof Array  && data2 instanceof Array) {\n    if (data1.length == data2.length) {\n      for (let i = 0; i < data1.length; i++) {\n        if (!compare(data1[i], data2[i])) {\n          return false;\n        }\n      }\n    } else {\n      return false;\n    }\n  } else {\n      if (Object.keys(data1).length == Object.keys(data2).length) {\n      for (let key in data1) {\n        if (!data2[key] || !compare(data1[key], data2[key])) {\n          return false;\n        }\n      }\n    } else {\n      return false;\n    }\n  }\n  return true;\n}\n```\n\n## æ·±æ‹·è´\n\n```javascript\nfunction isObject(value) {\n  const valueType = typeof value\n  return (value !== null) && (valueType === \"object\" || valueType === \"function\")\n}\n\nfunction deepClone(originValue) {\n  // åˆ¤æ–­ä¼ å…¥çš„originValueæ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹\n  if (!isObject(originValue)) {\n    return originValue\n  }\n\n  const newObject = {}\n  for (const key in originValue) {\n    newObject[key] = deepClone(originValue[key])\n  }\n  //è¿”å›é€šè¿‡é€’å½’æ·±å±‚éå†èµ‹å€¼åï¼Œå…¨æ–°çš„æ•°æ®å¯¹è±¡\n  return newObject\n}\n```\n\n## å®ç°Object.create()\n\nåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå®šä¹‰å…¶åŸå‹å¯¹è±¡å¹¶è®¾ç½®å…¶æšä¸¾å±æ€§\n\n```javascript\n// proto å¯ä»¥æ˜¯object æˆ–è€…function\nObject.myCreate = function (proto, defineProperties){\n    if((typeof proto === 'object' && proto !== null) || typeof proto === 'function'){\n        let obj = {};\n\n        // obj.__proto__ = proto;\n        Object.setPrototypeOf(obj, proto);\n        Object.defineProperty(obj, defineProperties);\n        return obj;\n    }else {\n        throw new TypeError('ç±»å‹é”™è¯¯');\n    }\n}\n```\n\n## å®ç°Object.assignï¼ˆæµ…æ‹·è´ï¼‰\n\n```javascript\nfunction myAssign(target,...objs){\n    if(target === null || target === undefined){\n        throw new TypeError(\"can not convert null or undefined to object\")\n    }\n    let res = Object(target)\n    objs.forEach(obj => {\n        'use strict'\n        if(obj != null && obj != undefined){\n            for(let key in obj){\n                //hasOwnPropertyç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å®šä¹‰åœ¨å¯¹è±¡æœ¬èº«è€Œä¸æ˜¯ç»§æ‰¿è‡ªåŸå‹é“¾çš„\n                if(Object.prototype.hasOwnProperty.call(obj,key)){\n                    res[key] = obj[key]\n                }\n            }\n        }\n    })\n    return res\n}\nObject.defineProperty(Object,'myAssign',{\n    value: myAssign,\n    writable: true,\n    configurable: true,\n    enumerable: false\n})\n```\n\n## trimæ–¹æ³•\n\n```javascript\nfunction myTrim(str) {\n  const reg = /^\\s+|\\s+$/g;\n  return str.replace(reg, '');\n}\n```\n\n## æ¨¡æ¿å­—ç¬¦ä¸²\n\n```javascript\nconst render = (template, data) => {\n    const reg = /\\$\\{(.*?)\\}/g;\n    template = template.replace(reg, (match, key) => {\n        let keys = key.trim().split('.');\n        return keys.reduce((obj, k) => obj?.[k], data) || '';\n    })\n    return template;\n}\n```\n\n## sleepå‡½æ•°\n\n```javascript\nfunction sleep(ms) {\n    return new Promise((resolve) => {\n        setTimeout(() => {\n            console.log('sleep...')\n            resolve()\n        }, ms);\n    })\n}\n\nasync function test(){\n    console.log('1');\n    await sleep(400)\n    console.log('2')\n}\n\ntest();\n```\n\n## åˆ©ç”¨setTimeoutå®ç°setInterval\n\n```javascript\nfunction coustomSetInterval(callback, time) {\n    let intervalId = null;\n    function loop() {\n        intervalId = setTimeout(() => {\n            callback();\n            loop();\n        }, time)\n    }\n    loop();\n    return () => clearTimeout(intervalId)\n}\nconst interval = coustomSetInterval(() => {\n    console.log('æƒ³ä½ äº†')\n}, 1000)\n\nsetTimeout(() => {\n    interval()\n}, 5000)\n```\n\n# ğŸš€ Promise æºç å®ç°å®Œå…¨æŒ‡å— - ä»é›¶æ‰‹å†™ Promise\n\n> ğŸ¯ **é˜…è¯»æœ¬èŠ‚ä½ å°†æ”¶è·**ï¼š\n>\n> - æ·±å…¥ç†è§£ Promise å†…éƒ¨è¿è¡Œæœºåˆ¶\n> - æ‰‹å†™ä¸€ä¸ªç¬¦åˆ Promise/A+ è§„èŒƒçš„ Promise\n> - æŒæ¡é¢è¯•ä¸­ Promise ç›¸å…³çš„æ ¸å¿ƒè€ƒç‚¹\n> - ç†è§£ async/await çš„å®ç°åŸç†\n\n## ğŸ“Œ å¼€ç¯‡ï¼šä¸ºä»€ä¹ˆè¦æ‰‹å†™ Promiseï¼Ÿ\n\nåœ¨é¢è¯•ä¸­ï¼ŒPromise ç›¸å…³çš„é¢˜ç›®å¯ä»¥è¯´æ˜¯å¿…è€ƒé¢˜ã€‚ä½†å¾ˆå¤šåŒå­¦åªä¼šç”¨ï¼Œä¸çŸ¥é“å…¶å†…éƒ¨åŸç†ã€‚ä»Šå¤©æˆ‘ä»¬å°±ä¸€èµ·æ¥æ­å¼€ Promise çš„ç¥ç§˜é¢çº±ï¼Œæ‰‹å†™ä¸€ä¸ªå®Œæ•´çš„ Promiseï¼\n\n## ä¸€ã€Promise åŸºç¡€æ¶æ„ - æ­å»ºåœ°åŸº ğŸ—ï¸\n\n### 1.1 æœ€ç®€å•çš„ Promise ç»“æ„\n\næˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„ç»“æ„å¼€å§‹ï¼Œå°±åƒç›–æˆ¿å­è¦å…ˆæ‰“åœ°åŸºï¼š\n\n```javascript\nclass MyPromise {\n    constructor(executor) {\n        // executor æ˜¯ä½¿ç”¨è€…ä¼ å…¥çš„å‡½æ•°ï¼Œå½¢å¦‚ (resolve, reject) => {}\n        \n        // å®šä¹‰ resolve å‡½æ•°\n        const resolve = (value) => {\n            console.log('è°ƒç”¨äº† resolveï¼Œå€¼ä¸ºï¼š', value);\n        }\n        \n        // å®šä¹‰ reject å‡½æ•°\n        const reject = (reason) => {\n            console.log('è°ƒç”¨äº† rejectï¼ŒåŸå› ä¸ºï¼š', reason);\n        }\n        \n        // ç«‹å³æ‰§è¡Œ executor\n        executor(resolve, reject);\n    }\n}\n\n// æµ‹è¯•ä¸€ä¸‹\nnew MyPromise((resolve, reject) => {\n    resolve('æˆåŠŸå•¦ï¼');\n});\n```\n\n### 1.2 Promise çš„ä¸‰ç§çŠ¶æ€ - çŠ¶æ€æœº ğŸš¦\n\nPromise å°±åƒä¸€ä¸ªæœ‰ä¸‰ç§çŠ¶æ€çš„äº¤é€šç¯ï¼š\n\n- ğŸŸ¡ **pending**ï¼ˆç­‰å¾…æ€ï¼‰ï¼šåˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥\n- ğŸŸ¢ **fulfilled**ï¼ˆæˆåŠŸæ€ï¼‰ï¼šæ“ä½œæˆåŠŸå®Œæˆ\n- ğŸ”´ **rejected**ï¼ˆå¤±è´¥æ€ï¼‰ï¼šæ“ä½œå¤±è´¥\n\n**é‡è¦ç‰¹æ€§**ï¼š\n\n1. çŠ¶æ€åªèƒ½ä» `pending` â†’ `fulfilled` æˆ– `pending` â†’ `rejected`\n2. çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±æ°¸è¿œä¸ä¼šå†å˜ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå« \"Promise\" - æ‰¿è¯ºï¼‰\n\nè®©æˆ‘ä»¬åŠ ä¸ŠçŠ¶æ€ç®¡ç†ï¼š\n\n```javascript\nclass MyPromise {\n    constructor(executor) {\n        // åˆå§‹çŠ¶æ€ä¸º pending\n        this.status = 'pending';\n        // æˆåŠŸçš„å€¼\n        this.value = undefined;\n        // å¤±è´¥çš„åŸå› \n        this.reason = undefined;\n        \n        // resolve å‡½æ•°ï¼šå°†çŠ¶æ€ä» pending æ”¹ä¸º fulfilled\n        const resolve = (value) => {\n            // åªæœ‰åœ¨ pending çŠ¶æ€æ‰èƒ½æ”¹å˜çŠ¶æ€ï¼ˆä¿è¯çŠ¶æ€åªæ”¹å˜ä¸€æ¬¡ï¼‰\n            if (this.status === 'pending') {\n                this.status = 'fulfilled';\n                this.value = value;\n            }\n        }\n        \n        // reject å‡½æ•°ï¼šå°†çŠ¶æ€ä» pending æ”¹ä¸º rejected\n        const reject = (reason) => {\n            if (this.status === 'pending') {\n                this.status = 'rejected';\n                this.reason = reason;\n            }\n        }\n        \n        // ç«‹å³æ‰§è¡Œ executorï¼Œå¹¶ä¼ å…¥ resolve å’Œ reject\n        try {\n            executor(resolve, reject);\n        } catch (error) {\n            // å¦‚æœæ‰§è¡Œå™¨æŠ›å‡ºå¼‚å¸¸ï¼ŒPromise åº”è¯¥è¢«æ‹’ç»\n            reject(error);\n        }\n    }\n}\n```\n\n## äºŒã€å®ç° then æ–¹æ³• - Promise çš„çµé­‚ âœ¨\n\n### 2.1 then æ–¹æ³•çš„åŸºæœ¬å®ç°\n\n`then` æ–¹æ³•æ˜¯ Promise çš„æ ¸å¿ƒï¼Œå®ƒç”¨æ¥æ³¨å†Œå½“ Promise çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ã€‚\n\n```javascript\nclass MyPromise {\n    // ... å‰é¢çš„ä»£ç \n\n    then(onFulfilled, onRejected) {\n        // å¦‚æœçŠ¶æ€æ˜¯ fulfilledï¼Œæ‰§è¡ŒæˆåŠŸå›è°ƒ\n        if (this.status === 'fulfilled') {\n            onFulfilled(this.value);\n        }\n        \n        // å¦‚æœçŠ¶æ€æ˜¯ rejectedï¼Œæ‰§è¡Œå¤±è´¥å›è°ƒ\n        if (this.status === 'rejected') {\n            onRejected(this.reason);\n        }\n    }\n}\n\n// æµ‹è¯•åŒæ­¥æƒ…å†µ\nconst promise = new MyPromise((resolve, reject) => {\n    resolve('æˆåŠŸï¼');\n});\n\npromise.then(\n    value => console.log('æˆåŠŸ:', value),\n    reason => console.log('å¤±è´¥:', reason)\n);\n```\n\n### 2.2 å¤„ç†å¼‚æ­¥æƒ…å†µ - å‘å¸ƒè®¢é˜…æ¨¡å¼ ğŸ“¢\n\nä¸Šé¢çš„ä»£ç æœ‰ä¸ªé—®é¢˜ï¼šå¦‚æœ executor ä¸­æœ‰å¼‚æ­¥æ“ä½œæ€ä¹ˆåŠï¼Ÿ\n\n```javascript\nconst promise = new MyPromise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('å¼‚æ­¥æˆåŠŸï¼');\n    }, 1000);\n});\n\n// æ­¤æ—¶çŠ¶æ€è¿˜æ˜¯ pendingï¼Œthen æ–¹æ³•ä¸ä¼šæ‰§è¡Œä»»ä½•å›è°ƒï¼\npromise.then(value => console.log(value));\n```\n\nè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨**å‘å¸ƒè®¢é˜…æ¨¡å¼**ï¼Œå…ˆæŠŠå›è°ƒå­˜èµ·æ¥ï¼Œç­‰çŠ¶æ€æ”¹å˜æ—¶å†æ‰§è¡Œï¼š\n\n```javascript\nclass MyPromise {\n    constructor(executor) {\n        this.status = 'pending';\n        this.value = undefined;\n        this.reason = undefined;\n        \n        // å­˜å‚¨æˆåŠŸå›è°ƒçš„æ•°ç»„\n        this.onFulfilledCallbacks = [];\n        // å­˜å‚¨å¤±è´¥å›è°ƒçš„æ•°ç»„\n        this.onRejectedCallbacks = [];\n        \n        const resolve = (value) => {\n            if (this.status === 'pending') {\n                this.status = 'fulfilled';\n                this.value = value;\n                // çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰§è¡Œæ‰€æœ‰çš„æˆåŠŸå›è°ƒ\n                this.onFulfilledCallbacks.forEach(fn => fn());\n            }\n        }\n        \n        const reject = (reason) => {\n            if (this.status === 'pending') {\n                this.status = 'rejected';\n                this.reason = reason;\n                // çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰§è¡Œæ‰€æœ‰çš„å¤±è´¥å›è°ƒ\n                this.onRejectedCallbacks.forEach(fn => fn());\n            }\n        }\n        \n        try {\n            executor(resolve, reject);\n        } catch (error) {\n            reject(error);\n        }\n    }\n    \n    then(onFulfilled, onRejected) {\n        if (this.status === 'fulfilled') {\n            onFulfilled(this.value);\n        }\n        \n        if (this.status === 'rejected') {\n            onRejected(this.reason);\n        }\n        \n        // å¦‚æœæ˜¯ pending çŠ¶æ€ï¼Œå°†å›è°ƒå­˜å‚¨èµ·æ¥\n        if (this.status === 'pending') {\n            this.onFulfilledCallbacks.push(() => {\n                onFulfilled(this.value);\n            });\n            this.onRejectedCallbacks.push(() => {\n                onRejected(this.reason);\n            });\n        }\n    }\n}\n```\n\n### 2.3 é“¾å¼è°ƒç”¨çš„å®ç° - then è¿”å› Promise ğŸ”—\n\nPromise æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯é“¾å¼è°ƒç”¨ã€‚è¦å®ç°é“¾å¼è°ƒç”¨ï¼Œ`then` æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ Promiseï¼š\n\n```javascript\nthen(onFulfilled, onRejected) {\n    // then æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise\n    return new MyPromise((resolve, reject) => {\n        // å°è£…ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œç»Ÿä¸€å¤„ç†æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µ\n        const fulfilledMicrotask = () => {\n            // ä½¿ç”¨ queueMicrotask åˆ›å»ºå¾®ä»»åŠ¡ï¼Œä¿è¯å¼‚æ­¥æ‰§è¡Œ\n            queueMicrotask(() => {\n                try {\n                    const x = onFulfilled(this.value);\n                    // å¤„ç†è¿”å›å€¼ï¼ˆè¯¦è§ä¸‹ä¸€èŠ‚ï¼‰\n                    resolvePromise(promise2, x, resolve, reject);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        };\n        \n        const rejectedMicrotask = () => {\n            queueMicrotask(() => {\n                try {\n                    const x = onRejected(this.reason);\n                    resolvePromise(promise2, x, resolve, reject);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        };\n        \n        if (this.status === 'fulfilled') {\n            fulfilledMicrotask();\n        } else if (this.status === 'rejected') {\n            rejectedMicrotask();\n        } else if (this.status === 'pending') {\n            this.onFulfilledCallbacks.push(fulfilledMicrotask);\n            this.onRejectedCallbacks.push(rejectedMicrotask);\n        }\n    });\n}\n```\n\n### 2.4 å¤„ç† then çš„è¿”å›å€¼ - resolvePromise ğŸ¯\n\nè¿™æ˜¯å®ç° Promise æœ€å¤æ‚çš„éƒ¨åˆ†ï¼Œéœ€è¦å¤„ç†å„ç§æƒ…å†µï¼š\n\n```javascript\nfunction resolvePromise(promise2, x, resolve, reject) {\n    // å¦‚æœ x === promise2ï¼Œä¼šé€ æˆå¾ªç¯å¼•ç”¨\n    if (x === promise2) {\n        return reject(new TypeError('Chaining cycle detected'));\n    }\n    \n    // å¦‚æœ x æ˜¯ Promise å®ä¾‹\n    if (x instanceof MyPromise) {\n        // ç­‰å¾… x çš„çŠ¶æ€æ”¹å˜ï¼Œç„¶åé€’å½’å¤„ç†\n        x.then(\n            value => resolvePromise(promise2, value, resolve, reject),\n            reason => reject(reason)\n        );\n        return;\n    }\n    \n    // å¦‚æœ x æ˜¯å¯¹è±¡æˆ–å‡½æ•°ï¼ˆå¯èƒ½æ˜¯ thenableï¼‰\n    if (x !== null && (typeof x === 'object' || typeof x === 'function')) {\n        let then;\n        try {\n            then = x.then;\n        } catch (error) {\n            return reject(error);\n        }\n        \n        // å¦‚æœ then æ˜¯å‡½æ•°ï¼Œè®¤ä¸º x æ˜¯ thenable\n        if (typeof then === 'function') {\n            let called = false; // é˜²æ­¢å¤šæ¬¡è°ƒç”¨\n            try {\n                then.call(\n                    x,\n                    value => {\n                        if (called) return;\n                        called = true;\n                        resolvePromise(promise2, value, resolve, reject);\n                    },\n                    reason => {\n                        if (called) return;\n                        called = true;\n                        reject(reason);\n                    }\n                );\n            } catch (error) {\n                if (called) return;\n                reject(error);\n            }\n        } else {\n            // å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œç›´æ¥ resolve\n            resolve(x);\n        }\n    } else {\n        // å¦‚æœ x æ˜¯æ™®é€šå€¼ï¼Œç›´æ¥ resolve\n        resolve(x);\n    }\n}\n```\n\n## ä¸‰ã€å®ç° Promise çš„é™æ€æ–¹æ³• ğŸ› ï¸\n\n### 3.1 Promise.resolve å’Œ Promise.reject\n\n```javascript\nclass MyPromise {\n    // å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæˆåŠŸçš„ Promise\n    static resolve(value) {\n        // å¦‚æœ value å·²ç»æ˜¯ Promiseï¼Œç›´æ¥è¿”å›\n        if (value instanceof MyPromise) {\n            return value;\n        }\n        \n        return new MyPromise(resolve => resolve(value));\n    }\n    \n    // å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå¤±è´¥çš„ Promise\n    static reject(reason) {\n        return new MyPromise((resolve, reject) => reject(reason));\n    }\n}\n```\n\n### 3.2 Promise.all - ä¸€ä¸ªéƒ½ä¸èƒ½å°‘ ğŸ¯\n\n`Promise.all` æ¥æ”¶ä¸€ä¸ª Promise æ•°ç»„ï¼Œåªæœ‰å…¨éƒ¨æˆåŠŸæ‰æˆåŠŸï¼Œæœ‰ä¸€ä¸ªå¤±è´¥å°±å¤±è´¥ï¼š\n\n```javascript\nstatic all(promises) {\n    return new MyPromise((resolve, reject) => {\n        const results = [];\n        let completedCount = 0;\n        \n        // å¤„ç†ç©ºæ•°ç»„çš„æƒ…å†µ\n        if (promises.length === 0) {\n            resolve(results);\n            return;\n        }\n        \n        promises.forEach((promise, index) => {\n            // å°†é Promise å€¼è½¬æ¢ä¸º Promise\n            MyPromise.resolve(promise).then(\n                value => {\n                    results[index] = value;\n                    completedCount++;\n                    \n                    // æ‰€æœ‰ Promise éƒ½æˆåŠŸäº†\n                    if (completedCount === promises.length) {\n                        resolve(results);\n                    }\n                },\n                reason => {\n                    // æœ‰ä¸€ä¸ªå¤±è´¥å°±ç›´æ¥ reject\n                    reject(reason);\n                }\n            );\n        });\n    });\n}\n```\n\n### 3.3 Promise.race - è°å¿«ç”¨è° ğŸƒ\n\n```javascript\nstatic race(promises) {\n    return new MyPromise((resolve, reject) => {\n        // ç©ºæ•°ç»„æ°¸è¿œ pending\n        if (promises.length === 0) return;\n        \n        promises.forEach(promise => {\n            // è°å…ˆå®Œæˆå°±ç”¨è°çš„ç»“æœ\n            MyPromise.resolve(promise).then(resolve, reject);\n        });\n    });\n}\n```\n\n### 3.4 Promise.allSettled - ç­‰å¾…æ‰€æœ‰ç»“æœ ğŸ“Š\n\nä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œç­‰æ‰€æœ‰ Promise éƒ½æœ‰ç»“æœï¼š\n\n```javascript\nstatic allSettled(promises) {\n    return new MyPromise((resolve) => {\n        const results = [];\n        let settledCount = 0;\n        \n        if (promises.length === 0) {\n            resolve(results);\n            return;\n        }\n        \n        promises.forEach((promise, index) => {\n            MyPromise.resolve(promise).then(\n                value => {\n                    results[index] = { status: 'fulfilled', value };\n                    settledCount++;\n                    if (settledCount === promises.length) {\n                        resolve(results);\n                    }\n                },\n                reason => {\n                    results[index] = { status: 'rejected', reason };\n                    settledCount++;\n                    if (settledCount === promises.length) {\n                        resolve(results);\n                    }\n                }\n            );\n        });\n    });\n}\n```\n\n### 3.5 Promise.any - ä¸€ä¸ªæˆåŠŸå°±å¤Ÿäº† âœ…\n\n```javascript\nstatic any(promises) {\n    return new MyPromise((resolve, reject) => {\n        const errors = [];\n        let rejectedCount = 0;\n        \n        if (promises.length === 0) {\n            reject(new AggregateError([], 'All promises were rejected'));\n            return;\n        }\n        \n        promises.forEach((promise, index) => {\n            MyPromise.resolve(promise).then(\n                value => {\n                    // æœ‰ä¸€ä¸ªæˆåŠŸå°± resolve\n                    resolve(value);\n                },\n                reason => {\n                    errors[index] = reason;\n                    rejectedCount++;\n                    \n                    // å…¨éƒ¨å¤±è´¥æ‰ reject\n                    if (rejectedCount === promises.length) {\n                        reject(new AggregateError(errors, 'All promises were rejected'));\n                    }\n                }\n            );\n        });\n    });\n}\n```\n\n## å››ã€å®ç° catch å’Œ finally ğŸ£\n\n### 4.1 catch - é”™è¯¯å¤„ç†\n\n```javascript\ncatch(onRejected) {\n    // catch å°±æ˜¯ then çš„è¯­æ³•ç³–\n    return this.then(null, onRejected);\n}\n```\n\n### 4.2 finally - æ— è®ºå¦‚ä½•éƒ½è¦æ‰§è¡Œ\n\n```javascript\nfinally(callback) {\n    return this.then(\n        // æˆåŠŸæ—¶æ‰§è¡Œ callbackï¼Œä½†ä¼ é€’åŸæ¥çš„å€¼\n        value => MyPromise.resolve(callback()).then(() => value),\n        // å¤±è´¥æ—¶æ‰§è¡Œ callbackï¼Œä½†ä¼ é€’åŸæ¥çš„é”™è¯¯\n        reason => MyPromise.resolve(callback()).then(() => { throw reason })\n    );\n}\n```\n\n## äº”ã€async/await çš„å®ç°åŸç† ğŸ”®\n\n### 5.1 ç†è§£ async/await\n\n`async/await` æœ¬è´¨ä¸Šæ˜¯ Generator + Promise çš„è¯­æ³•ç³–ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š\n\n```javascript\n// async å‡½æ•°\nasync function fetchData() {\n    const user = await getUser();\n    const posts = await getPosts(user.id);\n    return posts;\n}\n\n// ç­‰ä»·äº\nfunction fetchData() {\n    return spawn(function* () {\n        const user = yield getUser();\n        const posts = yield getPosts(user.id);\n        return posts;\n    });\n}\n```\n\n### 5.2 å®ç°è‡ªåŠ¨æ‰§è¡Œå™¨\n\n```javascript\nfunction spawn(genFunc) {\n    return new Promise((resolve, reject) => {\n        const gen = genFunc();\n        \n        function step(nextFunc) {\n            let next;\n            try {\n                next = nextFunc();\n            } catch (error) {\n                return reject(error);\n            }\n            \n            // Generator å‡½æ•°æ‰§è¡Œå®Œæ¯•\n            if (next.done) {\n                return resolve(next.value);\n            }\n            \n            // å°† yield çš„å€¼åŒ…è£…æˆ Promiseï¼Œç„¶åé€’å½’æ‰§è¡Œ\n            Promise.resolve(next.value).then(\n                value => step(() => gen.next(value)),\n                error => step(() => gen.throw(error))\n            );\n        }\n        \n        // å¼€å§‹æ‰§è¡Œ\n        step(() => gen.next());\n    });\n}\n```\n\n### 5.3 ä¸€ä¸ªæ›´ç®€å•çš„å®ç°\n\n```javascript\nfunction asyncToGenerator(generatorFunc) {\n    return function (...args) {\n        const gen = generatorFunc.apply(this, args);\n        \n        return new Promise((resolve, reject) => {\n            function step(key, arg) {\n                let generatorResult;\n                \n                try {\n                    generatorResult = gen[key](arg);\n                } catch (error) {\n                    return reject(error);\n                }\n                \n                const { value, done } = generatorResult;\n                \n                if (done) {\n                    return resolve(value);\n                } else {\n                    return Promise.resolve(value).then(\n                        val => step('next', val),\n                        err => step('throw', err)\n                    );\n                }\n            }\n            \n            step('next');\n        });\n    };\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst getData = asyncToGenerator(function* () {\n    const data1 = yield fetch('/api/1');\n    const data2 = yield fetch('/api/2');\n    return [data1, data2];\n});\n\ngetData().then(result => console.log(result));\n```\n\n## ğŸ¯ é¢è¯•é«˜é¢‘è€ƒç‚¹æ€»ç»“\n\n1. **Promise çš„çŠ¶æ€æœºåˆ¶**ï¼šä¸‰ç§çŠ¶æ€ï¼Œåªèƒ½å•å‘æ”¹å˜ï¼Œä¸€æ—¦æ”¹å˜ä¸å¯é€†\n2. **then çš„é“¾å¼è°ƒç”¨**ï¼šthen è¿”å›æ–°çš„ Promiseï¼Œæ ¹æ®å›è°ƒå‡½æ•°çš„è¿”å›å€¼å†³å®šæ–° Promise çš„çŠ¶æ€\n3. **å¾®ä»»åŠ¡é˜Ÿåˆ—**ï¼šPromise çš„å›è°ƒåœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œ\n4. **é”™è¯¯å¤„ç†**ï¼šcatch èƒ½æ•è·å‰é¢æ‰€æœ‰ then ä¸­çš„é”™è¯¯\n5. **Promise.all vs Promise.race**ï¼šä¸€ä¸ªè¦å…¨éƒ¨æˆåŠŸï¼Œä¸€ä¸ªè¦æœ€å¿«å®Œæˆ\n6. **async/await åŸç†**ï¼šGenerator + è‡ªåŠ¨æ‰§è¡Œå™¨ + Promise\n\n# æ¨¡æ¿æ¸²æŸ“å¼•æ“\n\n```xml\n<!DOCTYPE html>\n<html lang=\"zh\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>æ¨¡æ¿æ¸²æŸ“ç¤ºä¾‹</title>\n</head>\n<body>\n    <div id=\"app\"></div>\n\n    <script src=\"script.js\"></script>\n</body>\n</html>\n// æ¸²æŸ“å¼•æ“\nfunction renderTemplate(template, data) {\n\n    // å¤„ç†æ¡ä»¶åˆ¤æ–­\n    template = template.replace(/{{\\s*#if\\s*(\\w+)\\s*}}([\\s\\S]*?){{\\s*\\/if\\s*}}/g, function (_, condition, content) {\n        return data[condition] ? content : '';\n    });\n\n    // å¤„ç†å¾ªç¯\n    template = template.replace(/{{\\s*#each\\s*(\\w+)\\s*}}([\\s\\S]*?){{\\s*\\/each\\s*}}/g, function (_, arrayKey, content) {\n        let result = '';\n        let array = data[arrayKey];\n        if (Array.isArray(array)) {\n            array.forEach((item, index) => {\n                // åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ä½œç”¨åŸŸï¼Œé¿å…å†²çª\n                let temp = content;\n                // æ›¿æ¢æ¨¡æ¿å†…çš„ {{ this }} ä¸ºå¾ªç¯é¡¹\n                temp = temp.replace(/{{\\s*this\\s*}}/g, function () {\n                    return item;\n                });\n                // å¦‚æœæ˜¯å¯¹è±¡ï¼Œå¤„ç†å®ƒçš„å±æ€§\n                temp = temp.replace(/{{\\s*this\\.(\\w+)\\s*}}/g, function (_, prop) {\n                    return item[prop] || '';\n                });\n                // æ›¿æ¢å¾ªç¯ç´¢å¼•ï¼ˆå¦‚æœéœ€è¦ï¼‰\n                temp = temp.replace(/{{\\s*index\\s*}}/g, index);\n                // å°†å¤„ç†åçš„ç»“æœæ·»åŠ åˆ°æœ€ç»ˆç»“æœä¸­\n                result += temp;\n            });\n        }\n        return result;\n    });\n    // æ›¿æ¢å˜é‡ï¼Œä¸€å®šè¦æ”¾åˆ°æœ€åï¼ï¼\n    template = template.replace(/\\{\\{(.*?)\\}\\}/g, (match, key) => {\n        let keys = key.trim().split('.');\n        return keys.reduce((obj, k) => obj?.[k], data) || '';\n    })\n\n    return template;\n}\n\n// å®šä¹‰æ•°æ®\nconst data = {\n    name: \"å¼ ä¸‰\",\n    age: 25,\n    isEmployed: true,\n    occupation: \"å·¥ç¨‹å¸ˆ\",\n    hobbies: [\"é˜…è¯»\", \"ç¼–ç¨‹\", \"æ—…æ¸¸\"],\n    friends: [\n        { name: \"æå››\", age: 26 },\n        { name: \"ç‹äº”\", age: 24 }\n    ]\n};\n\n// å®šä¹‰æ¨¡æ¿\nconst template = `\n    <h1>ä¸ªäººä¿¡æ¯</h1>\n    <p>å§“å: {{ name }}</p>\n    <p>å¹´é¾„: {{ age }}</p>\n    <p>èŒä¸š: {{ occupation }}</p>\n\n    {{#if isEmployed}}\n        <p>å½“å‰çŠ¶æ€: åœ¨èŒ</p>\n    {{/if}}\n\n    <h2>å…´è¶£çˆ±å¥½</h2>\n    <ul>\n        {{#each hobbies}}\n            <li>{{ this }}</li>\n        {{/each}}\n    </ul>\n\n    <h2>æœ‹å‹åˆ—è¡¨</h2>\n    <ul>\n        {{#each friends}}\n            <li>{{ this.name }} - {{ this.age }} å²</li>\n        {{/each}}\n    </ul>\n`;\n\n// æ¸²æŸ“æ¨¡æ¿å¹¶æ’å…¥ HTML\ndocument.getElementById('app').innerHTML = renderTemplate(template, data);\n```\n\n# é˜²æŠ–æˆªæµ\n\n```JavaScript\nconst debounce = (fn, ms, Immediate = false) => {\n    // Immediateé€‰æ‹©æ˜¯å¦ç«‹å³æ‰§è¡Œ\n    let timer = null;\n    return function (...thisArgs) {\n        if (timer) {\n            clearTimeout(timer)\n        }\n        if (Immediate) {\n            let flag = !timer\n            flag && fn.apply(this, thisArgs)\n            timer = setTimeout(() => {\n                timer = null\n            }, ms)\n        } else {\n            timer = setTimeout(() => {\n                fn.apply(this, thisArgs)\n                timer = null\n            }, ms)\n        }\n    }\n}\n\nconst throttle = (fn, ms) => {\n    let timer = null;\n    return function (...thisArgs) {\n        if (!timer) {\n            fn.apply(this, thisArgs);\n            timer = setTimeout(() => {\n                timer = null;\n            }, ms);\n        }\n    }\n}\n```\n\n# æŠ€å·§\n\n## æ•°ç»„å»é‡\n\n```javascript\nlet arr = [1, 0, 2, 3, 4, 5, 2, 3, 4];\n//indexOfå»é‡\nfunction removeRepeat(arr) {\n  let res = [];\n  for (let i of arr) {\n    if (res.indexOf(i) == -1) {\n      res.push(i);\n    }\n  }\n  return res;\n}\n// set å»é‡\nfunction removeRepeat(arr) {\n  let res = new Set(arr);\n  return Array.from(res);\n}\n// forå¾ªç¯å»é‡\nfunction removeRepeat(arr) {\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = i + 1; j < arr.length; j++) {\n      if (arr[i] == arr[j]) {\n        arr.splice(j, 1);\n        j--;\n      }\n    }\n  }\n  return arr;\n}\n// filter å»é‡\nfunction removeRepeat(arr) {\n  return arr.filter((item, index) => {\n    return arr.indexOf(item) == index;\n  });\n}\n// includes å»é‡\nfunction removeRepeat(arr) {\n  let res = [];\n  for (let i of arr) {\n    if (!res.includes(i)) {\n      res.push(i);\n    }\n  }\n  return res;\n}\nlet res = removeRepeat(arr);\nconsole.log(res);\n```\n\n## å¿«æ’å’Œå½’å¹¶\n\n```javascript\nArray.prototype.quicksort = function (l, r) {\n    if (l >= r) return this;\n    let key = this[l];\n    let i = l - 1, j = r + 1;\n    while (i < j) {\n        do i++; while (this[i] < key);\n        do j--; while (this[j] > key);\n        if (i < j) [this[i], this[j]] = [this[j], this[i]];\n    }\n    this.quicksort(l, j);\n    this.quicksort(j + 1, r);\n    return this;\n}\nlet arr = [5,8,3,6,4,2];\nconsole.log(arr.quicksort(0, arr.length-1));\n\n\nArray.prototype.mergesort = function (temp, l, r) {\n    if (l >= r) return this;\n    let mid = l + r >> 1;\n    this.mergesort(temp, l, mid);\n    this.mergesort(temp, mid + 1, r);\n\n    let i = l, j = mid + 1, k = 0;\n    while (i <= mid && j <= r) {\n        if (this[i] <= this[j]) temp[k++] = this[i++];\n        else temp[k++] = this[j++];\n    }\n    while (i <= mid) temp[k++] = this[i++];\n    while (j <= r) temp[k++] = this[j++];\n\n    for (let m = 0, n = l; n <= r; m++, n++) {\n        this[n] = temp[m];\n    }\n    return this;\n}\n\nlet arr = [7, 1, 0, 3, 0, 5, 6, 4];\nconsole.log(arr.mergesort(Array(arr.length).fill(0), 0, arr.length - 1));\n```\n\n## ä¸‹åˆ’çº¿å’Œé©¼å³°ç›¸äº’è½¬æ¢\n\n```javascript\n//æ–¹å¼ä¸€ï¼šæ“ä½œå­—ç¬¦ä¸²æ•°ç»„\nfunction transformStr2Hump1(str) {\n    if(str == null) {\n        return \"\";\n    }\n    var strArr = str.split('-');\n    for(var i = 1; i < strArr.length; i++) {\n        strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].substring(1);\n    }\n    return strArr.join('');\n}\n\n//æ–¹å¼äºŒï¼šæ“ä½œå­—ç¬¦æ•°ç»„\nfunction transformStr2Hump2(str) {\n    if(str == null) {\n        return \"\";\n    }\n    var strArr  =str.split('');\n    for(var i = 0; i < strArr.length; i++) {\n        if(strArr[i] == \"-\"){\n            //åˆ é™¤-\n            strArr.splice(i, 1);\n            //å°†è¯¥å¤„æ”¹ä¸ºå¤§å†™\n            if(i < strArr.length) {\n                strArr[i] = strArr[i].toUpperCase();\n            }\n        }\n    }\n    return strArr.join(\"\");\n}\n\n//æ–¹å¼ä¸‰ï¼šåˆ©ç”¨æ­£åˆ™\nfunction transformStr2Hump3(str) {\n    if(str == null) {\n        return \"\";\n    }\n    var reg = /-(\\w)/g;//åŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿æˆ–æ±‰å­—\n    return str.replace(reg, function($0, $1) {\n        return $1.toUpperCase();\n    })\n}\n```\n\n## æ‡’åŠ è½½\n\n- é¦–å…ˆï¼Œä¸è¦å°†å›¾ç‰‡åœ°å€æ”¾åˆ°srcå±æ€§ä¸­ï¼Œè€Œæ˜¯æ”¾åˆ°å…¶å®ƒå±æ€§(data-original)ä¸­ã€‚\n- é¡µé¢åŠ è½½å®Œæˆåï¼Œæ ¹æ®scrollTopåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åœ¨ç”¨æˆ·çš„è§†é‡å†…ï¼Œå¦‚æœåœ¨ï¼Œåˆ™å°†data-originalå±æ€§ä¸­çš„å€¼å–å‡ºå­˜æ”¾åˆ°srcå±æ€§ä¸­ã€‚\n- åœ¨æ»šåŠ¨äº‹ä»¶ä¸­é‡å¤åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›å…¥è§†é‡ï¼Œå¦‚æœè¿›å…¥ï¼Œåˆ™å°†data-originalå±æ€§ä¸­çš„å€¼å–å‡ºå­˜æ”¾åˆ°srcå±æ€§ä¸­ã€‚\n\n>  elementNode.getAttribute(name)ï¼šæ–¹æ³•é€šè¿‡åç§°è·å–å±æ€§çš„å€¼ã€‚\n>\n>  elementNode.setAttribute(name, value)ï¼šæ–¹æ³•åˆ›å»ºæˆ–æ”¹å˜æŸä¸ªæ–°å±æ€§ã€‚\n>\n>  elementNode.removeAttribute(name)ï¼šæ–¹æ³•é€šè¿‡åç§°åˆ é™¤å±æ€§çš„å€¼ã€‚\n\n```javascript\n//æ‡’åŠ è½½ä»£ç å®ç°\nvar viewHeight = document.documentElement.clientHeight;//å¯è§†åŒ–åŒºåŸŸçš„é«˜åº¦\n\nfunction lazyload () {\n    //è·å–æ‰€æœ‰è¦è¿›è¡Œæ‡’åŠ è½½çš„å›¾ç‰‡\n    let eles = document.querySelectorAll('img[data-original][lazyload]');//è·å–å±æ€§åä¸­æœ‰data-originalçš„\n    Array.prototype.forEach.call(eles, function(item, index) {\n        let rect;\n        if(item.dataset.original === '') {\n            return;\n        }\n\n        rect = item.getBoundingClientRect();\n\n        //å›¾ç‰‡ä¸€è¿›å…¥å¯è§†åŒºï¼ŒåŠ¨æ€åŠ è½½\n        if(rect.bottom >= 0 && rect.top < viewHeight) {\n            !function () {\n                let img = new Image();\n                img.src = item.dataset.original;\n                img.onload = function () {\n                    item.src = img.src;\n                }\n                item.removeAttribute('data-original');\n                item.removeAttribute('lazyload');\n            }();\n        }\n    })\n}\n\nlazyload();\n\ndocument.addEventListener('scroll', lazyload);\n```\n\n## æ•°ç»„æ‰å¹³åŒ–\n\n```javascript\n//ä¼ å…¥å‚æ•° å†³å®šæ‰å¹³åŒ–çš„é˜¶æ•°\nArray.prototype._flat = function (n) {\n    let result = [];\n    let num = n;\n    for (let item of this) {\n        // å¦‚æœæ˜¯æ•°ç»„\n        if (Array.isArray(item)) {\n            n--;\n            //   æ²¡æœ‰æ‰å¹³åŒ–çš„ç©ºé—´ ç›´æ¥æ¨å…¥\n            if (n < 0) {\n                result.push(item);\n            }\n            // ç»§ç»­æ‰å¹³åŒ– å¹¶å°†nä¼ å…¥ å†³å®šitemè¿™ä¸€ä¸ªæ•°ç»„ä¸­çš„æ‰å¹³åŒ–\n            else {\n                result.push(...item._flat(n));\n            }\n        }\n        // ä¸æ˜¯æ•°ç»„ç›´æ¥æ¨å…¥\n        else {\n            result.push(item);\n        }\n        // æ¯æ¬¡å¾ªç¯ é‡ç½®n ä¸ºä¼ å…¥çš„å‚æ•° å› ä¸ºæ¯ä¸€é¡¹éƒ½éœ€è¦æ‰å¹³åŒ– éœ€è¦è¿›è¡Œåˆ¤æ–­\n        n = num;\n    }\n    return result;\n};\nlet arr = [1, 2, [3, 4], [5, 6, [7, 8]]];\nlet res = arr._flat(1);\nconsole.log(res); // [ 1, 2, 3, 4, 5, 6, [ 7, 8 ] ]\n```\n\n## è®¡ç®—å±æ€§\n\nè¯·ä¸è¦ä¸ºæ‰€æœ‰å‡½æ•°æ·»åŠ ç¼“å­˜ï¼\n\n```javascript\nconst computed = (func, content) => {\n    let cache = Object.create(null);\n    content = content || this;\n    return (...key) => {\n        console.log(cache)\n        if (!cache[key]) {\n            cache[key] = func.apply(content, key);\n        }\n        return cache[key];\n    }\n}\n```\n\n## æœ‰å¹¶å‘é™åˆ¶çš„Promiseè°ƒåº¦å™¨\n\n```JavaScript\nclass Scheduler{\n    constructor(limit){\n        this.limit = limit;\n        this.running = 0;\n        this.queue = [];\n    }\n    createTask(callback, duration){\n        return ()=>{\n            return new Promise((resolve, reject)=>{\n                setTimeout(()=>{\n                    callback();\n                    resolve();\n                },duration);\n            });\n        };\n    }\n    \n    add(callback, duration){\n        const task = this.createTask(callback, duration);\n        this.queue.push(task);\n    }\n    \n    start(){\n        for(let i=0;i<this.limit;++i){\n            this.schedule();\n        }\n    }\n    schedule(){\n        if(this.queue.length === 0 || this.running >= this.limit)return;\n        this.running++;\n        const task = this.queue.shift();\n        \n        task().then(()=>{\n            this.running--;\n            schedule();\n        });\n    }\n}\n```\n\n# ç½‘ç»œè¯·æ±‚å’Œè·¨åŸŸè§£å†³æ–¹æ¡ˆ\n\n## åŸç”Ÿajax\n\n```javascript\nfunction sendajax() {\n    // 1ã€ åˆå§‹åŒ–xhrå¯¹è±¡\n    const xhr = new XMLHttpRequest();\n    //  2ã€ å»ºç«‹è¿æ¥ è®¾ç½®è¯·æ±‚æ–¹æ³•å’Œurl\n    xhr.open(\"get\", \"./data.json\");\n    //   3ã€å‘é€è¯·æ±‚\n    xhr.send();\n    //   4ã€çŠ¶æ€æ”¹å˜æ—¶ è¿›è¡Œå›è°ƒ\n    xhr.onreadystatechange = function () {\n        // readyState æœ‰0-4 äº”ä¸ªå€¼\n        // 0 ä»£è¡¨ æœªåˆå§‹åŒ– 1 ä»£è¡¨ åˆå§‹åŒ–æˆåŠŸ 2 ä»£è¡¨å‘é€è¯·æ±‚\n        // 3 ä»£è¡¨è¿”å›äº†éƒ¨åˆ†æ•°æ® 4 ä»£è¡¨è¿”å›äº†å…¨éƒ¨æ•°æ®\n        if (xhr.readyState == 4) {\n            if (xhr.status >= 200 && xhr.status < 300) {\n                //   è¿›è¡ŒæˆåŠŸçš„æ“ä½œ\n                console.log(xhr.responseText);\n            }\n        }\n    };\n}\nsendajax();\n```\n\n## JSONPè·¨åŸŸ\n\né¦–å…ˆåœ¨å®¢æˆ·ç«¯æ³¨å†Œä¸€ä¸ªcallbackï¼Œç„¶åæŠŠcallbackçš„åå­—ä¼ ç»™æœåŠ¡å™¨ã€‚æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å…ˆç”Ÿæˆjsonæ•°æ®ï¼Œç„¶åä»¥JavaScriptçš„è¯­æ³•æ–¹å¼ï¼Œç”Ÿæˆfunctionï¼Œfunctionçš„åå­—å°±æ˜¯ä¼ é€’ä¸Šæ¥å¸¦å‚æ•°çš„jsonpï¼Œæœ€åå°†jsonæ•°æ®ç›´æ¥ä»¥å…¥å‚çš„æ–¹å¼ï¼Œæ”¾ç½®åœ¨functionä¸­ï¼Œè¿™æ ·å­å°±ç”ŸæˆJavaScriptè¯­æ³•æ–‡æ¡£ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œé€šè¿‡è§£æï¼Œå¹¶æ‰§è¡Œè¿”å›JavaScriptæ–‡æ¡£ï¼Œæ­¤æ—¶æ•°æ®ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥åˆ°å®¢æˆ·ç«¯é¢„å…ˆå®šä¹‰å¥½çš„callbackå‡½æ•°ä¸­ï¼Œç®€å•åœ°è¯´ï¼Œå°±æ˜¯**åˆ©ç”¨scriptæ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶åœ°æ¼æ´æ¥è¾¾åˆ°ç¬¬ä¸‰æ–¹é€šè®¯çš„ç›®çš„ï¼ˆhrefã€src éƒ½ä¸å—åŒæºç­–ç•¥çš„é™åˆ¶ã€‚ï¼‰**\n\n**ä¼˜ç‚¹ï¼š**\n\n- å®ƒä¸åƒXMLHttpRequestå¯¹è±¡å®ç°çš„Ajaxè¯·æ±‚é‚£æ ·å—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ï¼ŒJSONPå¯ä»¥è·¨è¶ŠåŒæºç­–ç•¥ï¼›\n- å®ƒçš„å…¼å®¹æ€§æ›´å¥½ï¼Œåœ¨æ›´åŠ å¤è€çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥è¿è¡Œï¼Œä¸éœ€è¦XMLHttpRequestæˆ–ActiveXçš„æ”¯æŒï¼›\n\n**ç¼ºç‚¹:**\n\n- å®ƒ**åªæ”¯æŒGETè¯·æ±‚**è€Œä¸æ”¯æŒPOSTç­‰å…¶å®ƒç±»å‹çš„HTTPè¯·æ±‚\n- å®ƒåªæ”¯æŒè·¨åŸŸHTTPè¯·æ±‚è¿™ç§æƒ…å†µï¼Œä¸èƒ½è§£å†³ä¸åŒåŸŸçš„ä¸¤ä¸ªé¡µé¢ä¹‹é—´å¦‚ä½•è¿›è¡ŒJavaScriptè°ƒç”¨çš„é—®é¢˜ã€‚\n- jsonpåœ¨è°ƒç”¨å¤±è´¥çš„æ—¶å€™ä¸ä¼šè¿”å›å„ç§HTTPçŠ¶æ€ç ã€‚\n- éœ€è¦åç«¯é…åˆ\n\n```javascript\n        function jsonp({url,params,cb}){\n                return new Promise((resolve, reject)=>{\n                        window[cb] = function(data){\n                                console.log(data)\n                                resolve(data);\n                                document.body.removeChild(script);\n                        }//windowå¯¹è±¡ä¸Šè®¾ç½®showæ–¹æ³•\n                        params= {...params,cb}\n                        let arrs = [];\n                        for (let key in params){\n                                arrs.push(`${key}=${params[key]}`)\n                        }\n                        let script = document.createElement('script');\n                        script.src = `${url}?${arrs.join('&')}`;\n                        script.onerror = () => reject('åŠ è½½å¤±è´¥') \n                        document.body.appendChild(script);\n                \n\n                })\n        }\n        jsonp({\n                url:\"http://localhost:3000/users\",\n                params:{name:\"jin\",age:12},\n                cb:'show'\n        }).then(data=>{\n                console.log(data)\n        })\n```\n\nåç«¯ï¼š\n\n```javascript\nlet express = require('express');\nlet app = express();\napp.get('/users', function(req, res, next) {\n        // æ¨¡æ‹Ÿçš„æ•°æ®\n        let {name,age,cb} = req.query\n        let data = `\"${name}ç°åœ¨${age}å²\"`\n        res.send(`${cb}(${data})`);// show(data)\n});\n\napp.listen(3000)\n```\n\n## corsè·¨åŸŸ\n\nåŒæºç­–ç•¥æ˜¯ä¸å…è®¸æ¥æ”¶å“åº”è€Œä¸æ˜¯ä¸å…è®¸å‘é€è¯·æ±‚ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åœ¨å“åº”å¤´ä¸­è®¾ç½®æŸäº›å­—æ®µæ¥å…è®¸æ»¡è¶³æ¡ä»¶çš„è¯·æ±‚è·¨åŸŸï¼Œæ¯”å¦‚è®¾ç½® `Access-Control-Allow-Origin` å­—æ®µå…è®¸æ¥è‡ªæŸä¸ªæºçš„è¯·æ±‚è·¨åŸŸï¼Œæ¯”å¦‚è®¾ç½® `Access-Control-Allow-Methods` å­—æ®µå…è®¸'GET'æˆ–è€…'POST'æ–¹å¼çš„è¯·æ±‚è·¨åŸŸ\n\nåç«¯ï¼š\n\n```javascript\nlet express = require('express');\nlet app = express();\napp.all('*', function (req, res, next) {\n  let origin = req.headers.origin\n        //è®¾ç½®å“ªä¸ªæºå¯ä»¥è®¿é—®æˆ‘\n  res.header(\"Access-Control-Allow-Origin\",origin);\n        // å…è®¸æºå¸¦å“ªä¸ªå¤´è®¿é—®æˆ‘\n  res.header(\"Access-Control-Allow-Headers\", \"name\");\n        // å…è®¸å“ªä¸ªæ–¹æ³•è®¿é—®æˆ‘\n  res.header(\"Access-Control-Allow-Methods\", \"POST\");\n        // å…è®¸æºå¸¦cookie\n  res.set(\"Access-Control-Allow-Credentials\", true);\n        // é¢„æ£€çš„å­˜æ´»æ—¶é—´\n  res.header(\"Access-Control-Max-Age\", 6);\n        // å…è®¸å‰ç«¯è·å–å“ªä¸ªå¤´\n        res.header(\"Access-Control-Expose-Headers\", \"name\");\n        // è¯·æ±‚å¤´çš„æ ¼å¼\n  res.header(\"Content-Type\", \"application/json;charset=utf-8\");        \n  next();\n});\napp.post('/getData', function(req, res, next) {\n        console.log(req.headers)\n        res.send(\"ä½ æ‹¿ä¸åˆ°æ•°æ®äº†ï¼\");\n});\n\napp.listen(4000)\n```\n\n![img](https://k0x1mohrv2i.feishu.cn/space/api/box/stream/download/asynccode/?code=NDZkMzY0OGQyNDNmNjUxZDIwMjU1MWNlN2E0Mzg4MWFfa29GVk90bXpPWThOWlE3b2RzVFJJclhjRG45R01BaXFfVG9rZW46TlBKZGJkQlJ4b0F3V3h4NDRxWWNHNmxnbldjXzE3NTMxNjg3NjA6MTc1MzE3MjM2MF9WNA)\n\néç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯`PUT`æˆ–`DELETE`ï¼Œæˆ–è€…`Content-Type`å­—æ®µçš„ç±»å‹æ˜¯`application/json`ã€‚\n\néç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸º\"é¢„æ£€\"è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚\n\næµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPåŠ¨è¯å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„`XMLHttpRequest`è¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚ ä»£ç ä¿®æ”¹ä¸€ä¸‹ï¼š\n\n```javascript\n// åœ¨è¯·æ±‚å¤´çš„è®¾ç½®ä¸­åŠ ä¸Š\nif(req.method ==='OPTIONS'){\n    res.end();//OPTIONSè¯·æ±‚ä¸åšä»»ä½•å¤„ç†\n}\n```\n\n![img](https://k0x1mohrv2i.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGZhMjliNjM3ZDgyYTViMWZjYjdkZGJkOGMxZDE4YTBfclJZQzR4MzMwZmRpd3J4MEl3UWlqbVE3NEU2UDZwODFfVG9rZW46Qk53bWJ2T2dSb3BoZU14eXNFRmNZN1M0blNYXzE3NTMxNjg3NjA6MTc1MzE3MjM2MF9WNA)\n\n## postMessageè·¨åŸŸ\n\n**ã€Œwindow.postMessage()ã€** æ–¹æ³•å¯ä»¥å®‰å…¨åœ°å®ç°è·¨æºé€šä¿¡ã€‚é€šå¸¸ï¼Œå¯¹äºä¸¤ä¸ªä¸åŒé¡µé¢çš„è„šæœ¬ï¼Œåªæœ‰å½“æ‰§è¡Œå®ƒä»¬çš„é¡µé¢ä½äºå…·æœ‰ç›¸åŒçš„åè®®ï¼ˆé€šå¸¸ä¸º httpsï¼‰ï¼Œç«¯å£å·ï¼ˆ443 ä¸º https çš„é»˜è®¤å€¼ï¼‰ï¼Œä»¥åŠä¸»æœº (ä¸¤ä¸ªé¡µé¢çš„æ¨¡æ•° [`Document.domain`]è®¾ç½®ä¸ºç›¸åŒçš„å€¼) æ—¶ï¼Œè¿™ä¸¤ä¸ªè„šæœ¬æ‰èƒ½ç›¸äº’é€šä¿¡ã€‚**ã€Œwindow.postMessage()ã€** æ–¹æ³•æä¾›äº†ä¸€ç§å—æ§æœºåˆ¶æ¥è§„é¿æ­¤é™åˆ¶ï¼Œåªè¦æ­£ç¡®çš„ä½¿ç”¨ï¼Œè¿™ç§æ–¹æ³•å°±å¾ˆå®‰å…¨ã€‚\n\n**ç”¨é€”**\n\n1.é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’\n\n2.å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’\n\n3.é¡µé¢ä¸åµŒå¥—çš„ iframe æ¶ˆæ¯ä¼ é€’\n\n**å®ç°**\n\na.html\n\n```xml\n<iframe src=\"http://localhost:4000/b.html\" frameborder=\"0\" id=\"frame\" onload=\"load()\"></iframe>\n<script>\n    function load(){\n        let frame = document.getElementById('frame');\n        frame.contentWindow.postMessage('ä½ å¥½','http://localhost:4000/');\n        //æ¥æ”¶\n        window.onmessage= function(e){\n            console.log(e.data)\n        }\n    }\n</script>\n```\n\nb.html\n\n```xml\nwindow.onmessage = function(e){\n    console.log(e.data);\n    //å‘é€\n    e.source.postMessage('hello',e.origin)\n}\n```\n\n## æœ¬åœ°ä»£ç†è·¨åŸŸ\n\nproxyå…¶å®å°±æ˜¯å› ä¸ºæµè§ˆå™¨åŒæºåè®®æ— æ³•è¯·æ±‚éåŒæºçš„åœ°å€ï¼Œä½†æ˜¯æœåŠ¡å™¨ç›´æ¥æ²¡æœ‰åŒæºåè®®ï¼Œåˆ©ç”¨å°†æœ¬åœ°è¯·æ±‚è½¬åˆ°æœ¬åœ°æœåŠ¡å™¨è¿›è¡Œä»£ç†è½¬å‘ï¼Œä»è€Œç»•è¿‡äº†åŒæºåè®®çš„é™åˆ¶ï¼Œé€šè¿‡ä»£ç†çš„å®ç°å¯ä»¥è§£å†³è·¨åŸŸçš„é—®é¢˜\n\né€šè¿‡è®¾ç½®ä¸€ä¸ª node åç«¯ä½œä¸ºä¸­é—´å±‚ï¼Œå‰ç«¯å‘é€çš„è¯·æ±‚é¦–å…ˆåˆ°è¾¾è¿™ä¸ªä¸­é—´å±‚ï¼Œç„¶åå†ç”±ä¸­é—´å±‚å°†è¯·æ±‚è½¬å‘åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚å“åº”è¿‡ç¨‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒæœåŠ¡å™¨å…ˆå“åº”ç»™ä¸­é—´å±‚ï¼Œä¸­é—´å±‚å†å°†å“åº”æ•°æ®å‘é€å›å‰ç«¯ã€‚\n\nè¿™ä¸ªä¸­é—´å±‚å°±èµ·åˆ°äº†ä¸€ä¸ªä»£ç†çš„ä½œç”¨ã€‚è¿™æ ·ï¼Œæµè§ˆå™¨çœ‹åˆ°çš„æ˜¯åŒæºè¯·æ±‚ï¼Œä»è€Œç»•è¿‡äº†CORSé™åˆ¶ã€‚\n\nå‡è®¾å‰ç«¯ç°åœ¨è¦å°†è¯·æ±‚å‘é€ç»™ [http://192.168.1.63:3000](https://link.juejin.cn?target=http%3A%2F%2F192.168.1.63%3A3000) è¿™ä¸ªåç«¯ï¼Œå°±å¯ä»¥å…ˆç”±æœ¬æœºçš„ 3001 ç«¯å£ä½œä¸€ä¸ªä»£ç†\n\n```xml\n<!-- å‰ç«¯ -->\n<body>\n    <script>\n        const xhr = new XMLHttpRequest()\n        xhr.open('GET', 'https://localhost:3001')\n        xhr.send()\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4 && xhr.status === 200) {\n                console.log(xhr.responseText)\n            }\n        }\n    </script>\n</body>\n```\n\næœ¬æœºåç«¯\n\n```javascript\n// åç«¯\nconst http = require('http')\n\n// ç›‘å¬æœ¬æœº3001ç«¯å£ï¼Œæœ‰æ–°è¯·æ±‚æ—¶è°ƒç”¨å›è°ƒå‡½æ•°\nhttp.createServer((req, res)  => {\n\n    // è®¾ç½®å“åº”å¤´ï¼Œä»¥å…è®¸å‰ç«¯åº”ç”¨è®¿é—®å“åº”å†…å®¹\n    res.writeHead(200, {\n        'Access-Control-Allow-Origin': '*'\n    })\n\n    // è½¬å‘è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå¹¶å¤„ç†å“åº”\n    http.request({\n        host: '192.168.1.63',\n        port: 3000,\n        path: '/',\n        method: 'GET',\n        headers: {}\n    }, proxyRes => {\n        proxyRes.on('data', chunk => {\n            res.end(chunk.toString())\n        })\n    }).end()\n    \n}).listen(3001)\n```\n\n### å„è„šæ‰‹æ¶çš„proxyé…ç½®ï¼š\n\n#### Webpack (4.x)\n\nåœ¨`webpack`ä¸­å¯ä»¥é…ç½®`proxy`æ¥å¿«é€Ÿè·å¾—æ¥å£ä»£ç†çš„èƒ½åŠ›ã€‚\n\n```JavaScript\nconst path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\n\nmodule.exports = {\n  entry: {\n    index: \"./index.js\"\n  },\n  output: {\n    filename: \"bundle.js\",\n    path: path.resolve(__dirname, \"dist\")\n  },\n  devServer: {\n    port: 8000,\n    proxy: {\n      \"/api\": {\n        target: \"http://localhost:8080\"\n      }\n    }\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      filename: \"index.html\",\n      template: \"webpack.html\"\n    })\n  ]\n};\n```\n\n#### **Vue-cli 2.x**\n\n```JavaScript\n// config/index.js\n\n...\nproxyTable: {\n  '/api': {\n     target: 'http://localhost:8080',\n  }\n},\n...\n```\n\n#### Vue-cli 3.x\n\n```JavaScript\n// vue.config.js å¦‚æœæ²¡æœ‰å°±æ–°å»º\nmodule.exports = {\n  devServer: {\n    port: 8000,\n    proxy: {\n      \"/api\": {\n        target: \"http://localhost:8080\"\n      }\n    }\n  }\n};\n```\n\n#### vite\n\n```javascript\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport styleImport, { VantResolve } from 'vite-plugin-style-import';\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n    vue(),\n    styleImport({\n      resolves: [VantResolve()],\n    }),],\n    server: { //ä¸»è¦æ˜¯åŠ ä¸Šè¿™æ®µä»£ç \n      host: '127.0.0.1',\n      port: 3000,\n      proxy: {\n        '/api': {\n          target: 'http://127.0.0.1:8888',        //å®é™…è¯·æ±‚åœ°å€\n          changeOrigin: true,\n          rewrite: (path) => path.replace(/^\\/api/, '')\n        },\n      }\n    }\n})\n```\n\n## nginxåå‘ä»£ç†è·¨åŸŸ\n\nåå‘ä»£ç†ä¸æœ¬åœ°ä»£ç†ç›¸åã€‚æœ¬åœ°ä»£ç†æ˜¯å®¢æˆ·ç«¯æå®šçš„ï¼Œåå‘ä»£ç†å°±æ˜¯æœåŠ¡ç«¯æå®šçš„\n\nåå‘ä»£ç†çš„æ˜¯åœ¨æœåŠ¡ç«¯å†…éƒ¨å®Œæˆã€‚\n\næ˜¯æœåŠ¡ç«¯ï¼ˆæ•°æ®åº”ç”¨ï¼‰å‘æœåŠ¡ç«¯ï¼ˆç½‘é¡µåº”ç”¨ï¼‰å‘é€æ•°æ®ï¼Œ æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ® å…¶æœ¬è´¨æ˜¯åœ¨æœåŠ¡ç«¯ï¼ˆç½‘é¡µåº”ç”¨ï¼‰é€šè¿‡é…ç½®Access-Control-Allow-Origin * æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚ç›¸å½“äºå¯¹åç«¯æ¥å£è¿›è¡Œäº†ç»Ÿä¸€çš„corsé…ç½®\n\n`Access-Control-Allow-Origin: *` å€¼è¡¨æ˜ï¼Œè¯¥èµ„æºå¯ä»¥è¢«**ä»»æ„**å¤–æºè®¿é—®ã€‚\n\n```bash\n    #é€šè¿‡é…ç½®nginxæ–‡ä»¶æ—¢å¯\n    \n    events{}\n\nhttp{\n    include       mime.types;\n    default_type  application/octet-stream;\n    server{\n        listen 80;\n        server_name 127.0.0.1;\n        root D:/nginx-1.26.1/dist;\n        index index.html;\n        location / {\n   \n               location /api {\n                proxy_pass http://127.0.0.1:8080/;\n                proxy_set_header Host $host;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_set_header X-Forwarded-Proto $scheme;\n\n                # è§£å†³è·¨åŸŸé—®é¢˜\n                add_header Access-Control-Allow-Origin *;\n                add_header Access-Control-Allow-Methods \"GET, POST, OPTIONS, HEAD, PUT, DELETE\";\n                add_header Access-Control-Allow-Headers \"Origin, X-Requested-With, Content-Type, Accept, Authorization, User-Agent, DNT\";\n                add_header Access-Control-Max-Age 86400;\n\n                \n            }\n        }\n    }\n}\n```\n\n# è®¾è®¡æ¨¡å¼\n\n## å•ä¾‹æ¨¡å¼\n\n```typescript\n// å•ä¾‹æ¨¡å¼ç¤ºä¾‹ä»£ç \nclass Singleton {\n  constructor() {\n    if (!Singleton.instance) {\n      Singleton.instance = this;\n    }\n    return Singleton.instance;\n  }\n\n  createInstance() {\n    const object = { name: \"example\" };\n    return object;\n  }\n\n  getInstance() {\n    if (!Singleton.instance) {\n      Singleton.instance = this.createInstance();\n    }\n    return Singleton.instance;\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst instance1 = new Singleton();\nconst instance2 = new Singleton();\n\nconsole.log(instance1 === instance2); // true\n```\n\n## å·¥å‚æ¨¡å¼\n\n```javascript\nclass Product {\n  constructor(name) {\n    this.name = name;\n  }\n\n  getName() {\n    return this.name;\n  }\n}\n\nclass ProductFactory {\n  static createProduct(name) {\n    return new Product(name);\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst product = ProductFactory.createProduct(\"Example Product\");\nconsole.log(product.getName()); // \"Example Product\"\n```\n\n## è§‚å¯Ÿè€…æ¨¡å¼\n\n```javascript\nclass Subject {\n  constructor() {\n    this.observers = [];\n  }\n\n  addObserver(observer) {\n    this.observers.push(observer);\n  }\n\n  removeObserver(observer) {\n    const index = this.observers.indexOf(observer);\n    if (index !== -1) {\n      this.observers.splice(index, 1);\n    }\n  }\n\n  notify(data) {\n    this.observers.forEach(observer => observer.update(data));\n  }\n}\n\nclass Observer {\n  update(data) {\n    console.log(`Received data: ${data}`);\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst subject = new Subject();\nconst observer1 = new Observer();\nconst observer2 = new Observer();\n\nsubject.addObserver(observer1);\nsubject.addObserver(observer2);\n\nsubject.notify(\"Hello World!\");\n```\n\n## è£…é¥°å™¨æ¨¡å¼\n\n```java\ninterface Component {\n  operation(): void;\n}\n\nclass ConcreteComponent implements Component {\n  public operation(): void {\n    console.log(\"ConcreteComponent: operation.\");\n  }\n}\n\nclass Decorator implements Component {\n  protected component: Component;\n\n  constructor(component: Component) {\n    this.component = component;\n  }\n\n  public operation(): void {\n    console.log(\"Decorator: operation.\");\n    this.component.operation();\n  }\n}\n\nclass ConcreteDecoratorA extends Decorator {\n  public operation(): void {\n    super.operation();\n    console.log(\"ConcreteDecoratorA: operation.\");\n  }\n}\n\nclass ConcreteDecoratorB extends Decorator {\n  public operation(): void {\n    super.operation();\n    console.log(\"ConcreteDecoratorB: operation.\");\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst concreteComponent = new ConcreteComponent();\nconst concreteDecoratorA = new ConcreteDecoratorA(concreteComponent);\nconst concreteDecoratorB = new ConcreteDecoratorB(concreteDecoratorA);\n\nconcreteDecoratorB.operation();\n```\n\n## ä»£ç†æ¨¡å¼\n\n```javascript\nconst target = {\n  method() {\n    console.log(\"Target method.\");\n  }\n};\n\nconst proxy = new Proxy(target, {\n  get(target, prop) {\n    console.log(`Called ${prop} method.`);\n    return target[prop];\n  }\n});\n\n// ä½¿ç”¨ç¤ºä¾‹\nproxy.method(); // \"Called method method. Target method.\"\n```\n\n## é€‚é…å™¨æ¨¡å¼\n\n```javascript\nclass Adaptee {\n  specificRequest() {\n    return \"é€‚é…è€…ä¸­çš„ä¸šåŠ¡ä»£ç è¢«è°ƒç”¨\";\n  }\n}\n\nclass Target {\n  constructor() {\n    this.adaptee = new Adaptee();\n  }\n\n  request() {\n    let info = this.adaptee.specificRequest();\n    return `${info} - è½¬æ¢å™¨ - é€‚é…å™¨ä»£ç è¢«è°ƒç”¨`;\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nlet target = new Target();\ntarget.request(); // \"é€‚é…è€…ä¸­çš„ä¸šåŠ¡ä»£ç è¢«è°ƒç”¨ - è½¬æ¢å™¨ - é€‚é…å™¨ä»£ç è¢«è°ƒç”¨\"\n```\n\n## MVCæ¨¡å¼\n\n```javascript\nclass Model {\n  constructor() {\n    this.data = {\n      name: \"example\",\n      age: 18,\n      gender: \"male\"\n    };\n  }\n\n  setData(key, value) {\n    this.data[key] = value;\n  }\n\n  getData() {\n    return this.data;\n  }\n}\n\nclass View {\n  constructor() {\n    this.container = document.createElement(\"div\");\n  }\n\n  render(data) {\n    const { name, age, gender } = data;\n    this.container.innerHTML = `\n      <p>Name: ${name}</p>\n      <p>Age: ${age}</p>\n      <p>Gender: ${gender}</p>\n    `;\n    document.body.appendChild(this.container);\n  }\n}\n\nclass Controller {\n  constructor(model, view) {\n    this.model = model;\n    this.view = view;\n    this.view.render(this.model.getData());\n  }\n\n  setData(key, value) {\n    this.model.setData(key, value);\n    this.view.render(this.model.getData());\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst model = new Model();\nconst view = new View();\nconst controller = new Controller(model, view);\n\ncontroller.setData(\"age\", 20);\n```\n\n## ç­–ç•¥æ¨¡å¼\n\nè¡¨å•éªŒè¯æƒ…æ™¯ï¼š\n\n```ts\n// éªŒè¯ç­–ç•¥\nconst validationStrategies = {\n  required: {\n    validate: (value) => value !== '',\n    message: 'è¯¥å­—æ®µä¸èƒ½ä¸ºç©º'\n  },\n  \n  minLength: {\n    validate: (value, length) => value.length >= length,\n    message: (length) => `æœ€å°‘éœ€è¦${length}ä¸ªå­—ç¬¦`\n  },\n  \n  email: {\n    validate: (value) => /^\\S+@\\S+\\.\\S+$/.test(value),\n    message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'\n  },\n  \n  phone: {\n    validate: (value) => /^1[3-9]\\d{9}$/.test(value),\n    message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·'\n  },\n  \n  custom: {\n    validate: (value, validator) => validator(value),\n    message: 'è‡ªå®šä¹‰éªŒè¯å¤±è´¥'\n  }\n};\n\n// è¡¨å•éªŒè¯å™¨\nclass FormValidator {\n  constructor() {\n    this.rules = [];\n  }\n  \n  // æ·»åŠ éªŒè¯è§„åˆ™\n  addRule(field, strategy, ...params) {\n    this.rules.push({\n      field,\n      strategy,\n      params\n    });\n  }\n  \n  // æ‰§è¡ŒéªŒè¯\n  validate(formData) {\n    const errors = [];\n    \n    for (const rule of this.rules) {\n      const { field, strategy, params } = rule;\n      const value = formData[field];\n      const validationStrategy = validationStrategies[strategy];\n      \n      if (!validationStrategy.validate(value, ...params)) {\n        errors.push({\n          field,\n          message: typeof validationStrategy.message === 'function' \n            ? validationStrategy.message(...params)\n            : validationStrategy.message\n        });\n      }\n    }\n    \n    return {\n      isValid: errors.length === 0,\n      errors\n    };\n  }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst validator = new FormValidator();\nvalidator.addRule('username', 'required');\nvalidator.addRule('username', 'minLength', 3);\nvalidator.addRule('email', 'required');\nvalidator.addRule('email', 'email');\nvalidator.addRule('phone', 'phone');\n\nconst formData = {\n  username: 'ab',\n  email: 'invalid-email',\n  phone: '12345678901'\n};\n\nconst result = validator.validate(formData);\nconsole.log(result);\n// {\n//   isValid: false,\n//   errors: [\n//     { field: 'username', message: 'æœ€å°‘éœ€è¦3ä¸ªå­—ç¬¦' },\n//     { field: 'email', message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€' },\n//     { field: 'phone', message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·' }\n//   ]\n// }\n```\n\n","tags":["ç§‹æ‹›","ES","é¢è¯•é¢˜","å‰ç«¯æ‰‹æ’•"],"categories":["ç§‹æ‹›å‡†å¤‡"]},{"title":"ã€ç§‹æ‹›å¤‡æˆ˜ã€‘è®¡ç®—æœºç½‘ç»œ","url":"/2025/07/22/ã€ç§‹æ‹›å¤‡æˆ˜ã€‘è®¡ç®—æœºç½‘ç»œ/","content":"\n# å‰è¨€\n\nè®¡ç®—æœºç½‘ç»œä½œä¸ºå‰ç«¯å¼€å‘ä¸­ç»•ä¸å¼€çš„åŸºç¡€çŸ¥è¯†ï¼Œé¢è¯•æ—¶ä¹Ÿç‰¹çˆ±é—®ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æœ‰å¯èƒ½è¢«æ‰“ä¸€ä¸ªå†·ä¸é˜²ã€‚è¿™ä»½æ–‡æ¡£æ—¨åœ¨æ•´ç†å‰ç«¯é¢è¯•ä¸­é«˜é¢‘å‡ºç°çš„è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ç‚¹ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°æ­£åœ¨å‡†å¤‡é¢è¯•çš„ä½ ã€‚\n\nå†…å®¹åŸºäºä¸ªäººé¢è¯•ç»éªŒå’Œå­¦ä¹ æ€»ç»“ï¼Œå¦‚æœ‰ä¸å½“ä¹‹å¤„ï¼Œæ¬¢è¿æŒ‡æ­£äº¤æµã€‚  æœ¬æ–‡ä¸è¿½æ±‚é¢é¢ä¿±åˆ°ï¼Œè€Œæ˜¯èšç„¦äºå‰ç«¯é¢è¯•ä¸­çš„é«˜é¢‘è€ƒç‚¹ï¼ŒåŠ›æ±‚æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½è®²é€å½»ã€è®²å®ç”¨ã€‚\n\n# ä¸€ã€HTTP åè®®ç¯‡\n\n## 1.1 HTTP åŸºç¡€\n\n- HTTP æ˜¯ä»€ä¹ˆï¼Ÿ\n- HTTP è¯·æ±‚æ–¹æ³•è¯¦è§£\n- HTTP çŠ¶æ€ç åˆ†ç±»åŠå¸¸è§çŠ¶æ€ç \n- HTTP æŠ¥æ–‡ç»“æ„\n  - \n\n## 1.2 HTTP ç¼“å­˜æœºåˆ¶\n\n- å¼ºç¼“å­˜ vs åå•†ç¼“å­˜\n- Cache-Control è¯¦è§£\n- ETag å’Œ Last-Modified\n- ç¼“å­˜ä½ç½®ï¼ˆMemory Cacheã€Disk Cacheç­‰ï¼‰\n  - \n\n## 1.3 HTTP ç‰ˆæœ¬æ¼”è¿›\n\n- HTTP/1.0 vs HTTP/1.1\n- HTTP/2 çš„ä¼˜åŠ¿ï¼ˆå¤šè·¯å¤ç”¨ã€æœåŠ¡å™¨æ¨é€ç­‰ï¼‰\n- HTTP/3 å’Œ QUIC åè®®\n  - \n\n## 1.4 HTTPS å®‰å…¨é€šä¿¡\n\n- HTTP vs HTTPS\n- HTTPS åŠ å¯†åŸç†\n- è¯ä¹¦éªŒè¯è¿‡ç¨‹\n- ä¸­é—´äººæ”»å‡»\n  - \n\n# äºŒã€TCP/IP åè®®ç¯‡\n\n## 2.1 TCP åŸºç¡€\n\n- TCP ä¸‰æ¬¡æ¡æ‰‹è¯¦è§£\n- TCP å››æ¬¡æŒ¥æ‰‹è¯¦è§£\n- ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸¤æ¬¡è¡Œä¸è¡Œï¼Ÿ\n- TIME_WAIT çŠ¶æ€çš„ä½œç”¨\n  - \n\n## 2.2 TCP å¯é ä¼ è¾“\n\n- åºåˆ—å·å’Œç¡®è®¤åº”ç­”\n- è¶…æ—¶é‡ä¼ æœºåˆ¶\n- æµé‡æ§åˆ¶ï¼ˆæ»‘åŠ¨çª—å£ï¼‰\n- æ‹¥å¡æ§åˆ¶\n  - \n\n## 2.3 TCP vs UDP\n\n- ä¸¤è€…çš„åŒºåˆ«å¯¹æ¯”\n- å„è‡ªçš„åº”ç”¨åœºæ™¯\n- ä¸ºä»€ä¹ˆè§†é¢‘ç›´æ’­å¸¸ç”¨ UDPï¼Ÿ\n  - \n\n# ä¸‰ã€æµè§ˆå™¨ç½‘ç»œç¯‡\n\n## 3.1 è·¨åŸŸé—®é¢˜\n\n- åŒæºç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ\n- è·¨åŸŸçš„è§£å†³æ–¹æ¡ˆæ±‡æ€»\n- CORS è¯¦è§£\n- JSONP åŸç†åŠé™åˆ¶\n- å…¶ä»–è·¨åŸŸæ–¹æ¡ˆ\n  - \n\n## 3.2 ç»å…¸é—®é¢˜ï¼šä» URL åˆ°é¡µé¢å±•ç¤º\n\n- DNS è§£æè¿‡ç¨‹\n- å»ºç«‹ TCP è¿æ¥\n- å‘é€ HTTP è¯·æ±‚\n- æœåŠ¡å™¨å¤„ç†è¯·æ±‚\n- æµè§ˆå™¨æ¸²æŸ“é¡µé¢\n  - \n\n## 3.3 WebSocket\n\n- WebSocket vs HTTP\n- WebSocket è¿æ¥è¿‡ç¨‹\n- åº”ç”¨åœºæ™¯\n  - \n\n# å››ã€Web å®‰å…¨ç¯‡\n\n## 4.1 XSS æ”»å‡»\n\n- XSS ç±»å‹ï¼ˆåå°„å‹ã€å­˜å‚¨å‹ã€DOMå‹ï¼‰\n- XSS é˜²å¾¡ç­–ç•¥\n- CSP å†…å®¹å®‰å…¨ç­–ç•¥\n  - \n\n## 4.2 CSRF æ”»å‡»\n\n- CSRF æ”»å‡»åŸç†\n- CSRF é˜²å¾¡æ–¹æ³•\n- SameSite Cookie\n  - \n\n## 4.3 å…¶ä»–å®‰å…¨é—®é¢˜\n\n- SQL æ³¨å…¥\n- ç‚¹å‡»åŠ«æŒ\n- ä¸­é—´äººæ”»å‡»\n  - \n\n# äº”ã€æ€§èƒ½ä¼˜åŒ–ç¯‡\n\n## 5.1 ç½‘ç»œå±‚ä¼˜åŒ–\n\n- å‡å°‘ HTTP è¯·æ±‚æ•°\n- ä½¿ç”¨ HTTP/2\n- å¯ç”¨ Gzip å‹ç¼©\n- ä½¿ç”¨ CDN\n  - \n\n## 5.2 èµ„æºåŠ è½½ä¼˜åŒ–\n\n- é¢„åŠ è½½ï¼ˆpreloadã€prefetchï¼‰\n- æ‡’åŠ è½½\n- å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥\n  - \n\n# å…­ã€å®æˆ˜é¢˜ç›®ç¯‡\n\nï¼ˆæ”¶å½•å„å¤§å…¬å¸çœŸå®é¢è¯•é¢˜åŠè¯¦è§£ï¼‰","tags":["è®¡ç®—æœºç½‘ç»œ","ç§‹æ‹›","é¢è¯•å…«è‚¡æ–‡"],"categories":["ç§‹æ‹›å‡†å¤‡"]},{"title":"ã€å»ºç«™æ—¥å¿—ã€‘SimonæˆåŠŸæ¬å®¶","url":"/2025/06/12/ã€å»ºç«™æ—¥å¿—ã€‘Simonå·²ç€é™†/","content":"\nä¹‹å‰ç”¨Wordpresså»ºçš„ç½‘ç«™çªç„¶ç‚¸äº†T_Tï¼Œåªå¥½æ¬å®¶åˆ°Hexoè¿™è¾¹æ¥ï¼Œè™½ç„¶ä¹‹å‰å°±æƒ³æ¢æˆssgé™æ€ç½‘ç«™å°±æ˜¯äº†ã€‚æ¯•ç«ŸWordpressåšå®¢ç³»ç»Ÿä¸Šä¼ æ–‡ç« å¤ªä¾¿ç§˜äº†ï¼Œå®Œå…¨ç”¨ä¸æƒ¯ä»–çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè¿˜æ˜¯MDå¤§æ³•å¥½å•Šï¼\n","tags":["å»ºç«™æ—¥å¿—","ç”Ÿæ´»è®°å½•"]}]